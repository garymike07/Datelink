{"data":"aW1wb3J0IHsgdiB9IGZyb20gImNvbnZleC92YWx1ZXMiOwppbXBvcnQgeyBtdXRhdGlvbiwgcXVlcnkgfSBmcm9tICIuL19nZW5lcmF0ZWQvc2VydmVyIjsKCi8qKgogKiBBY3RpdmF0ZSAyLWRheSBmcmVlIHRyaWFsIGZvciBuZXcgdXNlcgogKi8KZXhwb3J0IGNvbnN0IGFjdGl2YXRlRnJlZVRyaWFsID0gbXV0YXRpb24oewogIGFyZ3M6IHsgdXNlcklkOiB2LmlkKCJ1c2VycyIpIH0sCiAgaGFuZGxlcjogYXN5bmMgKGN0eCwgYXJncykgPT4gewogICAgY29uc3QgdXNlciA9IGF3YWl0IGN0eC5kYi5nZXQoYXJncy51c2VySWQpOwogICAgaWYgKCF1c2VyKSB0aHJvdyBuZXcgRXJyb3IoIlVzZXIgbm90IGZvdW5kIik7CgogICAgLy8gQ2hlY2sgaWYgdHJpYWwgYWxyZWFkeSB1c2VkCiAgICBpZiAodXNlci5mcmVlVHJpYWxVc2VkKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcigiRnJlZSB0cmlhbCBhbHJlYWR5IHVzZWQiKTsKICAgIH0KCiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpOwogICAgY29uc3QgdHJpYWxFbmQgPSBub3cgKyAoNDggKiA2MCAqIDYwICogMTAwMCk7IC8vIDQ4IGhvdXJzCgogICAgLy8gVXBkYXRlIHVzZXIgd2l0aCB0cmlhbCBpbmZvCiAgICBhd2FpdCBjdHguZGIucGF0Y2goYXJncy51c2VySWQsIHsKICAgICAgZnJlZVRyaWFsU3RhcnRlZEF0OiBub3csCiAgICAgIGZyZWVUcmlhbEVuZHNBdDogdHJpYWxFbmQsCiAgICAgIGZyZWVUcmlhbFVzZWQ6IHRydWUsCiAgICB9KTsKCiAgICByZXR1cm4gewogICAgICB0cmlhbFN0YXJ0ZWQ6IG5vdywKICAgICAgdHJpYWxFbmRzOiB0cmlhbEVuZCwKICAgICAgbWVzc2FnZTogIkVuam95IHlvdXIgMi1kYXkgZnJlZSB0cmlhbCEgWW91IGNhbiB1bmxvY2sgdXAgdG8gNSBwcm9maWxlcy4iLAogICAgfTsKICB9LAp9KTsKCi8qKgogKiBDaGVjayBpZiB1c2VyIGlzIGluIGZyZWUgdHJpYWwgcGVyaW9kCiAqLwpleHBvcnQgY29uc3QgaXNJbkZyZWVUcmlhbCA9IHF1ZXJ5KHsKICBhcmdzOiB7IHVzZXJJZDogdi5pZCgidXNlcnMiKSB9LAogIGhhbmRsZXI6IGFzeW5jIChjdHgsIGFyZ3MpID0+IHsKICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBjdHguZGIuZ2V0KGFyZ3MudXNlcklkKTsKICAgIGlmICghdXNlcikgcmV0dXJuIGZhbHNlOwoKICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7CiAgICAKICAgIGlmICgKICAgICAgdXNlci5mcmVlVHJpYWxTdGFydGVkQXQgJiYKICAgICAgdXNlci5mcmVlVHJpYWxFbmRzQXQgJiYKICAgICAgdXNlci5mcmVlVHJpYWxFbmRzQXQgPiBub3cKICAgICkgewogICAgICByZXR1cm4gewogICAgICAgIGlzQWN0aXZlOiB0cnVlLAogICAgICAgIGVuZHNBdDogdXNlci5mcmVlVHJpYWxFbmRzQXQsCiAgICAgICAgaG91cnNSZW1haW5pbmc6IE1hdGguY2VpbCgodXNlci5mcmVlVHJpYWxFbmRzQXQgLSBub3cpIC8gKDYwICogNjAgKiAxMDAwKSksCiAgICAgIH07CiAgICB9CgogICAgcmV0dXJuIHsgaXNBY3RpdmU6IGZhbHNlIH07CiAgfSwKfSk7CgovKioKICogR2V0IGZyZWUgdHJpYWwgc3RhdHVzIHdpdGggdW5sb2NrIGNvdW50CiAqLwpleHBvcnQgY29uc3QgZ2V0RnJlZVRyaWFsU3RhdHVzID0gcXVlcnkoewogIGFyZ3M6IHsgdXNlcklkOiB2LmlkKCJ1c2VycyIpIH0sCiAgaGFuZGxlcjogYXN5bmMgKGN0eCwgYXJncykgPT4gewogICAgY29uc3QgdXNlciA9IGF3YWl0IGN0eC5kYi5nZXQoYXJncy51c2VySWQpOwogICAgaWYgKCF1c2VyKSB0aHJvdyBuZXcgRXJyb3IoIlVzZXIgbm90IGZvdW5kIik7CgogICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTsKICAgIGNvbnN0IGlzQWN0aXZlID0KICAgICAgdXNlci5mcmVlVHJpYWxTdGFydGVkQXQgJiYKICAgICAgdXNlci5mcmVlVHJpYWxFbmRzQXQgJiYKICAgICAgdXNlci5mcmVlVHJpYWxFbmRzQXQgPiBub3c7CgogICAgLy8gQ291bnQgcHJvZmlsZSB1bmxvY2tzIGR1cmluZyB0cmlhbAogICAgY29uc3QgdW5sb2NrcyA9IGF3YWl0IGN0eC5kYgogICAgICAucXVlcnkoInByb2ZpbGVVbmxvY2tzIikKICAgICAgLndpdGhJbmRleCgidXNlcklkIiwgKHEpID0+IHEuZXEoInVzZXJJZCIsIGFyZ3MudXNlcklkKSkKICAgICAgLmNvbGxlY3QoKTsKCiAgICBjb25zdCBmcmVlVHJpYWxVbmxvY2tzID0gdW5sb2Nrcy5maWx0ZXIoCiAgICAgICh1KSA9PiB1LnVubG9ja01ldGhvZCA9PT0gImZyZWVfdHJpYWwiCiAgICApLmxlbmd0aDsKCiAgICByZXR1cm4gewogICAgICB0cmlhbEFjdGl2ZTogaXNBY3RpdmUsCiAgICAgIHRyaWFsU3RhcnRlZDogdXNlci5mcmVlVHJpYWxTdGFydGVkQXQsCiAgICAgIHRyaWFsRW5kczogdXNlci5mcmVlVHJpYWxFbmRzQXQsCiAgICAgIHRyaWFsVXNlZDogdXNlci5mcmVlVHJpYWxVc2VkIHx8IGZhbHNlLAogICAgICBwcm9maWxlVW5sb2Nrc1VzZWQ6IGZyZWVUcmlhbFVubG9ja3MsCiAgICAgIHByb2ZpbGVVbmxvY2tzUmVtYWluaW5nOiBNYXRoLm1heCgwLCA1IC0gZnJlZVRyaWFsVW5sb2NrcyksCiAgICAgIGNhblVubG9ja01vcmU6IGlzQWN0aXZlICYmIGZyZWVUcmlhbFVubG9ja3MgPCA1LAogICAgfTsKICB9LAp9KTsK"}