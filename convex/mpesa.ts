{"data":"aW1wb3J0IHsgaW50ZXJuYWxNdXRhdGlvbiwgbXV0YXRpb24gfSBmcm9tICIuL19nZW5lcmF0ZWQvc2VydmVyIjsKaW1wb3J0IHsgdiB9IGZyb20gImNvbnZleC92YWx1ZXMiOwoKLy8gU3R1YiBpbnRlZ3JhdGlvbiBwb2ludCBmb3IgU2FmYXJpY29tIERhcmFqYSBTVEsgUHVzaC4KLy8gVGhpcyBwcm9qZWN0IGN1cnJlbnRseSBjb25maXJtcyBwYXltZW50cyBpbW1lZGlhdGVseSBmcm9tIHRoZSBjbGllbnQgKGRldi1mcmllbmRseSkuCi8vIFdoZW4geW91IGFkZCByZWFsIGNyZWRlbnRpYWxzL3dlYmhvb2tzLCBtb3ZlIGNvbmZpcm1hdGlvbiBpbnRvIHRoaXMgbW9kdWxlLgoKZXhwb3J0IGNvbnN0IGluaXRpYXRlTXBlc2FQYXltZW50ID0gaW50ZXJuYWxNdXRhdGlvbih7CiAgYXJnczogewogICAgcGhvbmVOdW1iZXI6IHYuc3RyaW5nKCksCiAgICBhbW91bnQ6IHYubnVtYmVyKCksCiAgICB1c2VySWQ6IHYuaWQoInVzZXJzIiksCiAgICBwYXltZW50SWQ6IHYuaWQoInBheW1lbnRzIiksCiAgfSwKICBoYW5kbGVyOiBhc3luYyAoY3R4LCBhcmdzKSA9PiB7CiAgICBjb25zdCBwYXltZW50ID0gYXdhaXQgY3R4LmRiLmdldChhcmdzLnBheW1lbnRJZCk7CiAgICBpZiAoIXBheW1lbnQpIHRocm93IG5ldyBFcnJvcigiUGF5bWVudCBub3QgZm91bmQiKTsKICAgIGlmIChwYXltZW50LnVzZXJJZCAhPT0gYXJncy51c2VySWQpIHRocm93IG5ldyBFcnJvcigiVW5hdXRob3JpemVkIik7CgogICAgYXdhaXQgY3R4LmRiLnBhdGNoKGFyZ3MucGF5bWVudElkLCB7CiAgICAgIHN0YXR1czogInByb2Nlc3NpbmciLAogICAgICBtZXRhZGF0YTogewogICAgICAgIC4uLihwYXltZW50Lm1ldGFkYXRhIGFzIGFueSksCiAgICAgICAgcGhvbmVOdW1iZXI6IGFyZ3MucGhvbmVOdW1iZXIsCiAgICAgIH0sCiAgICB9KTsKCiAgICByZXR1cm4geyBzdGF0dXM6ICJwcm9jZXNzaW5nIiB9OwogIH0sCn0pOwoKZXhwb3J0IGNvbnN0IG1wZXNhQ2FsbGJhY2sgPSBtdXRhdGlvbih7CiAgYXJnczogewogICAgdHJhbnNhY3Rpb25JZDogdi5zdHJpbmcoKSwKICAgIHN0YXR1czogdi5zdHJpbmcoKSwKICAgIG1ldGFkYXRhOiB2Lm9wdGlvbmFsKHYuYW55KCkpLAogIH0sCiAgaGFuZGxlcjogYXN5bmMgKGN0eCwgYXJncykgPT4gewogICAgY29uc3QgcGF5bWVudCA9IGF3YWl0IGN0eC5kYgogICAgICAucXVlcnkoInBheW1lbnRzIikKICAgICAgLndpdGhJbmRleCgidHJhbnNhY3Rpb25JZCIsIChxKSA9PiBxLmVxKCJ0cmFuc2FjdGlvbklkIiwgYXJncy50cmFuc2FjdGlvbklkKSkKICAgICAgLmZpcnN0KCk7CiAgICBpZiAoIXBheW1lbnQpIHRocm93IG5ldyBFcnJvcigiUGF5bWVudCBub3QgZm91bmQiKTsKCiAgICBhd2FpdCBjdHguZGIucGF0Y2gocGF5bWVudC5faWQsIHsKICAgICAgc3RhdHVzOiBhcmdzLnN0YXR1cywKICAgICAgbWV0YWRhdGE6IHsgLi4uKHBheW1lbnQubWV0YWRhdGEgYXMgYW55KSwgLi4uKGFyZ3MubWV0YWRhdGEgYXMgYW55KSB9LAogICAgICBjb21wbGV0ZWRBdDogYXJncy5zdGF0dXMgPT09ICJjb21wbGV0ZWQiID8gRGF0ZS5ub3coKSA6IHBheW1lbnQuY29tcGxldGVkQXQsCiAgICB9KTsKCiAgICByZXR1cm4geyBvazogdHJ1ZSB9OwogIH0sCn0pOwo="}