{"data":"aW1wb3J0IHsgdXNlRWZmZWN0LCB1c2VSZWYsIHVzZVN0YXRlIH0gZnJvbSAicmVhY3QiOwppbXBvcnQgeyB1c2VBY3Rpb24sIHVzZU11dGF0aW9uLCB1c2VRdWVyeSB9IGZyb20gImNvbnZleC9yZWFjdCI7CmltcG9ydCB7IGFwaSB9IGZyb20gIi4uLy4uLy4uL2NvbnZleC9fZ2VuZXJhdGVkL2FwaSI7CmltcG9ydCB7CiAgRGlhbG9nLAogIERpYWxvZ0NvbnRlbnQsCiAgRGlhbG9nRGVzY3JpcHRpb24sCiAgRGlhbG9nSGVhZGVyLAogIERpYWxvZ1RpdGxlLAp9IGZyb20gIkAvY29tcG9uZW50cy91aS9kaWFsb2ciOwppbXBvcnQgeyBCdXR0b24gfSBmcm9tICJAL2NvbXBvbmVudHMvdWkvYnV0dG9uIjsKaW1wb3J0IHsgQ2FyZCwgQ2FyZENvbnRlbnQgfSBmcm9tICJAL2NvbXBvbmVudHMvdWkvY2FyZCI7CmltcG9ydCB7IEJhZGdlIH0gZnJvbSAiQC9jb21wb25lbnRzL3VpL2JhZGdlIjsKaW1wb3J0IHsgSW5wdXQgfSBmcm9tICJAL2NvbXBvbmVudHMvdWkvaW5wdXQiOwppbXBvcnQgeyBMb2FkZXIyLCBMb2NrLCBTcGFya2xlcywgQ3JlZGl0Q2FyZCwgQ2xvY2sgfSBmcm9tICJsdWNpZGUtcmVhY3QiOwppbXBvcnQgeyB1c2VUb2FzdCB9IGZyb20gIkAvaG9va3MvdXNlLXRvYXN0IjsKaW1wb3J0IHsgdXNlQXV0aCB9IGZyb20gIkAvY29udGV4dHMvQXV0aENvbnRleHQiOwoKaW50ZXJmYWNlIFByb2ZpbGVVbmxvY2tNb2RhbFByb3BzIHsKICBpc09wZW46IGJvb2xlYW47CiAgb25DbG9zZTogKCkgPT4gdm9pZDsKICB0YXJnZXRVc2VySWQ6IHN0cmluZzsKICB0YXJnZXRVc2VyTmFtZT86IHN0cmluZzsKICBvblVubG9ja1N1Y2Nlc3M/OiAoKSA9PiB2b2lkOwp9CgpleHBvcnQgZnVuY3Rpb24gUHJvZmlsZVVubG9ja01vZGFsKHsKICBpc09wZW4sCiAgb25DbG9zZSwKICB0YXJnZXRVc2VySWQsCiAgdGFyZ2V0VXNlck5hbWUgPSAidGhpcyBwcm9maWxlIiwKICBvblVubG9ja1N1Y2Nlc3MsCn06IFByb2ZpbGVVbmxvY2tNb2RhbFByb3BzKSB7CiAgY29uc3QgeyB0b2FzdCB9ID0gdXNlVG9hc3QoKTsKICBjb25zdCB7IHVzZXI6IGN1cnJlbnRVc2VyIH0gPSB1c2VBdXRoKCk7CiAgY29uc3QgW2lzVW5sb2NraW5nLCBzZXRJc1VubG9ja2luZ10gPSB1c2VTdGF0ZShmYWxzZSk7CiAgY29uc3QgW3NlbGVjdGVkT3B0aW9uLCBzZXRTZWxlY3RlZE9wdGlvbl0gPSB1c2VTdGF0ZTwidHJpYWwiIHwgIndlZWtseSIgfCAibW9udGhseSIgfCAib25jZSIgfCBudWxsPihudWxsKTsKCiAgY29uc3QgZnJlZVRyaWFsU3RhdHVzID0gdXNlUXVlcnkoCiAgICBhcGkuZnJlZVRyaWFsLmdldEZyZWVUcmlhbFN0YXR1cywKICAgIGN1cnJlbnRVc2VyID8geyB1c2VySWQ6IGN1cnJlbnRVc2VyLl9pZCB9IDogInNraXAiCiAgKTsKICAKICBjb25zdCB1bmxvY2tQcm9maWxlID0gdXNlTXV0YXRpb24oYXBpLnByb2ZpbGVVbmxvY2tzLnVubG9ja1Byb2ZpbGUpOwogIGNvbnN0IGluaXRpYXRlUGF5bWVudCA9IHVzZUFjdGlvbihhcGkucGF5bWVudHMuaW5pdGlhdGVQYXltZW50KTsKICBjb25zdCByZWZyZXNoUGF5bWVudFN0YXR1cyA9IHVzZUFjdGlvbihhcGkucGF5bWVudHNTdGF0dXMucmVmcmVzaFBheW1lbnRTdGF0dXMpOwoKICBjb25zdCBbcGhvbmVOdW1iZXIsIHNldFBob25lTnVtYmVyXSA9IHVzZVN0YXRlKCIiKTsKICBjb25zdCBbcGVuZGluZ1BheW1lbnRJZCwgc2V0UGVuZGluZ1BheW1lbnRJZF0gPSB1c2VTdGF0ZTxzdHJpbmcgfCBudWxsPihudWxsKTsKICBjb25zdCBbdmVyaWZpY2F0aW9uU3RhdHVzLCBzZXRWZXJpZmljYXRpb25TdGF0dXNdID0gdXNlU3RhdGU8ImlkbGUiIHwgInBlbmRpbmciIHwgImNvbXBsZXRlZCIgfCAiZmFpbGVkIj4oImlkbGUiKTsKICBjb25zdCBwb2xsVGltZXIgPSB1c2VSZWY8bnVtYmVyIHwgbnVsbD4obnVsbCk7CgogIGNvbnN0IGhhbmRsZVVubG9jayA9IGFzeW5jIChtZXRob2Q6ICJ0cmlhbCIgfCAid2Vla2x5IiB8ICJtb250aGx5IiB8ICJvbmNlIikgPT4gewogICAgaWYgKCFjdXJyZW50VXNlcikgcmV0dXJuOwoKICAgIC8vIFBhaWQgb3B0aW9ucyBuZWVkIGEgcGhvbmUgbnVtYmVyIGZvciBTVEsgcHVzaAogICAgaWYgKG1ldGhvZCAhPT0gInRyaWFsIiAmJiBwaG9uZU51bWJlci50cmltKCkubGVuZ3RoIDwgOSkgewogICAgICB0b2FzdCh7IHRpdGxlOiAiUGhvbmUgbnVtYmVyIHJlcXVpcmVkIiwgZGVzY3JpcHRpb246ICJFbnRlciBhIHZhbGlkIE0tUGVzYSBwaG9uZSBudW1iZXIgdG8gcGF5LiIgfSk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBzZXRJc1VubG9ja2luZyh0cnVlKTsKICAgIC8vIHJlc2V0IHBlci1hdHRlbXB0IHN0YXRlCiAgICBzZXRQZW5kaW5nUGF5bWVudElkKG51bGwpOwogICAgc2V0VmVyaWZpY2F0aW9uU3RhdHVzKCJpZGxlIik7CgogICAgc2V0U2VsZWN0ZWRPcHRpb24obWV0aG9kKTsKCiAgICB0cnkgewogICAgICBpZiAobWV0aG9kID09PSAidHJpYWwiKSB7CiAgICAgICAgLy8gVXNlIGZyZWUgdHJpYWwKICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB1bmxvY2tQcm9maWxlKHsKICAgICAgICAgIHVzZXJJZDogY3VycmVudFVzZXIuX2lkLAogICAgICAgICAgdGFyZ2V0VXNlcklkOiB0YXJnZXRVc2VySWQgYXMgYW55LAogICAgICAgICAgbWV0aG9kOiAiZnJlZV90cmlhbCIsCiAgICAgICAgfSk7CgogICAgICAgIGlmIChyZXN1bHQuc3VjY2VzcykgewogICAgICAgICAgdG9hc3QoewogICAgICAgICAgICB0aXRsZTogIlByb2ZpbGUgVW5sb2NrZWQhIPCfjokiLAogICAgICAgICAgICBkZXNjcmlwdGlvbjogYFlvdSB1c2VkIDEgb2YgeW91ciAke2ZyZWVUcmlhbFN0YXR1cz8ucHJvZmlsZVVubG9ja3NSZW1haW5pbmd9IGZyZWUgdHJpYWwgdW5sb2Nrcy5gLAogICAgICAgICAgfSk7CiAgICAgICAgICBvblVubG9ja1N1Y2Nlc3M/LigpOwogICAgICAgICAgb25DbG9zZSgpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChtZXRob2QgPT09ICJ3ZWVrbHkiIHx8IG1ldGhvZCA9PT0gIm1vbnRobHkiKSB7CiAgICAgICAgY29uc3QgYW1vdW50ID0gbWV0aG9kID09PSAid2Vla2x5IiA/IDEwMCA6IDM1MDsKICAgICAgICBjb25zdCBwbGFuRHVyYXRpb24gPSBtZXRob2QgPT09ICJ3ZWVrbHkiID8gIjFfd2VlayIgOiAiMV9tb250aCI7CgogICAgICAgIGNvbnN0IHsgcGF5bWVudElkIH0gPSBhd2FpdCBpbml0aWF0ZVBheW1lbnQoewogICAgICAgICAgdXNlcklkOiBjdXJyZW50VXNlci5faWQgYXMgYW55LAogICAgICAgICAgYW1vdW50LAogICAgICAgICAgY3VycmVuY3k6ICJLRVMiLAogICAgICAgICAgcGF5bWVudE1ldGhvZDogIm1wZXNhIiwKICAgICAgICAgIHByb2R1Y3RUeXBlOiAic3Vic2NyaXB0aW9uIiwKICAgICAgICAgIHBsYW46ICJwcmVtaXVtIiwKICAgICAgICAgIHBsYW5EdXJhdGlvbiwKICAgICAgICAgIG1ldGFkYXRhOiB7IHBob25lTnVtYmVyOiBwaG9uZU51bWJlci50cmltKCkgfSwKICAgICAgICB9KTsKCiAgICAgICAgc2V0UGVuZGluZ1BheW1lbnRJZChwYXltZW50SWQpOwogICAgICAgIHNldFZlcmlmaWNhdGlvblN0YXR1cygicGVuZGluZyIpOwoKICAgICAgICBjb25zdCB0aWNrID0gYXN5bmMgKCkgPT4gewogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgcmVmcmVzaFBheW1lbnRTdGF0dXMoeyBwYXltZW50SWQ6IHBheW1lbnRJZCBhcyBhbnksIHVzZXJJZDogY3VycmVudFVzZXIuX2lkIGFzIGFueSB9KTsKICAgICAgICAgICAgaWYgKHJlcy5zdGF0dXMgPT09ICJjb21wbGV0ZWQiKSB7CiAgICAgICAgICAgICAgc2V0VmVyaWZpY2F0aW9uU3RhdHVzKCJjb21wbGV0ZWQiKTsKICAgICAgICAgICAgICBhd2FpdCB1bmxvY2tQcm9maWxlKHsKICAgICAgICAgICAgICAgIHVzZXJJZDogY3VycmVudFVzZXIuX2lkLAogICAgICAgICAgICAgICAgdGFyZ2V0VXNlcklkOiB0YXJnZXRVc2VySWQgYXMgYW55LAogICAgICAgICAgICAgICAgbWV0aG9kOiAicHJlbWl1bV9zdWJzY3JpcHRpb24iLAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIHRvYXN0KHsgdGl0bGU6ICJQcmVtaXVtIEFjdGl2YXRlZCEg4pyoIiwgZGVzY3JpcHRpb246ICJQYXltZW50IGNvbmZpcm1lZCBhbmQgcHJvZmlsZSB1bmxvY2tlZC4iIH0pOwogICAgICAgICAgICAgIHNldElzVW5sb2NraW5nKGZhbHNlKTsKICAgICAgICAgICAgICBzZXRTZWxlY3RlZE9wdGlvbihudWxsKTsKICAgICAgICAgICAgICBvblVubG9ja1N1Y2Nlc3M/LigpOwogICAgICAgICAgICAgIG9uQ2xvc2UoKTsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHJlcy5zdGF0dXMgPT09ICJmYWlsZWQiKSB7CiAgICAgICAgICAgICAgc2V0VmVyaWZpY2F0aW9uU3RhdHVzKCJmYWlsZWQiKTsKICAgICAgICAgICAgICB0b2FzdCh7IHRpdGxlOiAiUGF5bWVudCBmYWlsZWQiLCBkZXNjcmlwdGlvbjogIlRyYW5zYWN0aW9uIGZhaWxlZCBvciB0aW1lZCBvdXQuIiB9KTsKICAgICAgICAgICAgICBzZXRJc1VubG9ja2luZyhmYWxzZSk7CiAgICAgICAgICAgICAgc2V0U2VsZWN0ZWRPcHRpb24obnVsbCk7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgLy8ga2VlcCBwb2xsaW5nCiAgICAgICAgICB9CiAgICAgICAgICBwb2xsVGltZXIuY3VycmVudCA9IHdpbmRvdy5zZXRUaW1lb3V0KHRpY2ssIDMwMDApOwogICAgICAgIH07CgogICAgICAgIHBvbGxUaW1lci5jdXJyZW50ID0gd2luZG93LnNldFRpbWVvdXQodGljaywgMjAwMCk7CiAgICAgIH0gZWxzZSBpZiAobWV0aG9kID09PSAib25jZSIpIHsKICAgICAgICBjb25zdCB7IHBheW1lbnRJZCB9ID0gYXdhaXQgaW5pdGlhdGVQYXltZW50KHsKICAgICAgICAgIHVzZXJJZDogY3VycmVudFVzZXIuX2lkIGFzIGFueSwKICAgICAgICAgIGFtb3VudDogMTAsCiAgICAgICAgICBjdXJyZW5jeTogIktFUyIsCiAgICAgICAgICBwYXltZW50TWV0aG9kOiAibXBlc2EiLAogICAgICAgICAgcHJvZHVjdFR5cGU6ICJwcm9maWxlX3VubG9jayIsCiAgICAgICAgICB0YXJnZXRVc2VySWQ6IHRhcmdldFVzZXJJZCBhcyBhbnksCiAgICAgICAgICBtZXRhZGF0YTogeyBwaG9uZU51bWJlcjogcGhvbmVOdW1iZXIudHJpbSgpIH0sCiAgICAgICAgfSk7CgogICAgICAgIHNldFBlbmRpbmdQYXltZW50SWQocGF5bWVudElkKTsKICAgICAgICBzZXRWZXJpZmljYXRpb25TdGF0dXMoInBlbmRpbmciKTsKCiAgICAgICAgY29uc3QgdGljayA9IGFzeW5jICgpID0+IHsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHJlZnJlc2hQYXltZW50U3RhdHVzKHsgcGF5bWVudElkOiBwYXltZW50SWQgYXMgYW55LCB1c2VySWQ6IGN1cnJlbnRVc2VyLl9pZCBhcyBhbnkgfSk7CiAgICAgICAgICAgIGlmIChyZXMuc3RhdHVzID09PSAiY29tcGxldGVkIikgewogICAgICAgICAgICAgIHNldFZlcmlmaWNhdGlvblN0YXR1cygiY29tcGxldGVkIik7CiAgICAgICAgICAgICAgYXdhaXQgdW5sb2NrUHJvZmlsZSh7CiAgICAgICAgICAgICAgICB1c2VySWQ6IGN1cnJlbnRVc2VyLl9pZCwKICAgICAgICAgICAgICAgIHRhcmdldFVzZXJJZDogdGFyZ2V0VXNlcklkIGFzIGFueSwKICAgICAgICAgICAgICAgIG1ldGhvZDogInBhaWRfdW5sb2NrIiwKICAgICAgICAgICAgICAgIHBheW1lbnRJZDogcGF5bWVudElkIGFzIGFueSwKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB0b2FzdCh7IHRpdGxlOiAiUHJvZmlsZSBVbmxvY2tlZCEg8J+UkyIsIGRlc2NyaXB0aW9uOiAiUGF5bWVudCBjb25maXJtZWQgYW5kIHByb2ZpbGUgdW5sb2NrZWQuIiB9KTsKICAgICAgICAgICAgICBzZXRJc1VubG9ja2luZyhmYWxzZSk7CiAgICAgICAgICAgICAgc2V0U2VsZWN0ZWRPcHRpb24obnVsbCk7CiAgICAgICAgICAgICAgb25VbmxvY2tTdWNjZXNzPy4oKTsKICAgICAgICAgICAgICBvbkNsb3NlKCk7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChyZXMuc3RhdHVzID09PSAiZmFpbGVkIikgewogICAgICAgICAgICAgIHNldFZlcmlmaWNhdGlvblN0YXR1cygiZmFpbGVkIik7CiAgICAgICAgICAgICAgdG9hc3QoeyB0aXRsZTogIlBheW1lbnQgZmFpbGVkIiwgZGVzY3JpcHRpb246ICJUcmFuc2FjdGlvbiBmYWlsZWQgb3IgdGltZWQgb3V0LiIgfSk7CiAgICAgICAgICAgICAgc2V0SXNVbmxvY2tpbmcoZmFsc2UpOwogICAgICAgICAgICAgIHNldFNlbGVjdGVkT3B0aW9uKG51bGwpOwogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgfSBjYXRjaCB7CiAgICAgICAgICAgIC8vIGtlZXAgcG9sbGluZwogICAgICAgICAgfQogICAgICAgICAgcG9sbFRpbWVyLmN1cnJlbnQgPSB3aW5kb3cuc2V0VGltZW91dCh0aWNrLCAzMDAwKTsKICAgICAgICB9OwoKICAgICAgICBwb2xsVGltZXIuY3VycmVudCA9IHdpbmRvdy5zZXRUaW1lb3V0KHRpY2ssIDIwMDApOwogICAgICB9CiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7CiAgICAgIHRvYXN0KHsKICAgICAgICB0aXRsZTogIlVubG9jayBGYWlsZWQiLAogICAgICAgIGRlc2NyaXB0aW9uOiBlcnJvci5tZXNzYWdlIHx8ICJTb21ldGhpbmcgd2VudCB3cm9uZy4gUGxlYXNlIHRyeSBhZ2Fpbi4iLAogICAgICAgIHZhcmlhbnQ6ICJkZXN0cnVjdGl2ZSIsCiAgICAgIH0pOwogICAgfSBmaW5hbGx5IHsKICAgICAgLy8gRm9yIHBhaWQgZmxvd3Mgd2Uga2VlcCB0aGUgVUkgaW4gInBlbmRpbmciIHdoaWxlIHdlIHBvbGwuCiAgICAgIGlmIChtZXRob2QgPT09ICJ0cmlhbCIpIHsKICAgICAgICBzZXRJc1VubG9ja2luZyhmYWxzZSk7CiAgICAgICAgc2V0U2VsZWN0ZWRPcHRpb24obnVsbCk7CiAgICAgIH0KICAgIH0KICB9OwoKICBjb25zdCBzaG93RnJlZVRyaWFsID0gZnJlZVRyaWFsU3RhdHVzPy50cmlhbEFjdGl2ZSAmJiBmcmVlVHJpYWxTdGF0dXM/LmNhblVubG9ja01vcmU7CgogIHVzZUVmZmVjdCgoKSA9PiB7CiAgICByZXR1cm4gKCkgPT4gewogICAgICBpZiAocG9sbFRpbWVyLmN1cnJlbnQpIHdpbmRvdy5jbGVhclRpbWVvdXQocG9sbFRpbWVyLmN1cnJlbnQpOwogICAgfTsKICB9LCBbXSk7CgogIHJldHVybiAoCiAgICA8RGlhbG9nIG9wZW49e2lzT3Blbn0gb25PcGVuQ2hhbmdlPXtvbkNsb3NlfT4KICAgICAgPERpYWxvZ0NvbnRlbnQgY2xhc3NOYW1lPSJzbTptYXgtdy1bNTAwcHhdIj4KICAgICAgICA8RGlhbG9nSGVhZGVyPgogICAgICAgICAgPERpYWxvZ1RpdGxlIGNsYXNzTmFtZT0iZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTIiPgogICAgICAgICAgICA8TG9jayBjbGFzc05hbWU9ImgtNSB3LTUiIC8+CiAgICAgICAgICAgIFVubG9jayB7dGFyZ2V0VXNlck5hbWV9J3MgUHJvZmlsZQogICAgICAgICAgPC9EaWFsb2dUaXRsZT4KICAgICAgICAgIDxEaWFsb2dEZXNjcmlwdGlvbj4KICAgICAgICAgICAgQ2hvb3NlIGhvdyB5b3UnZCBsaWtlIHRvIHVubG9jayB0aGlzIHByb2ZpbGUgYW5kIHZpZXcgZnVsbCBkZXRhaWxzLgogICAgICAgICAgPC9EaWFsb2dEZXNjcmlwdGlvbj4KICAgICAgICA8L0RpYWxvZ0hlYWRlcj4KCiAgICAgICAgPGRpdiBjbGFzc05hbWU9InNwYWNlLXktMiI+CiAgICAgICAgICA8SW5wdXQKICAgICAgICAgICAgcGxhY2Vob2xkZXI9Ik0tUGVzYSBwaG9uZSBlLmcuIDA3MTIzNDU2NzgiCiAgICAgICAgICAgIHZhbHVlPXtwaG9uZU51bWJlcn0KICAgICAgICAgICAgb25DaGFuZ2U9eyhlKSA9PiBzZXRQaG9uZU51bWJlcihlLnRhcmdldC52YWx1ZSl9CiAgICAgICAgICAgIGRpc2FibGVkPXtpc1VubG9ja2luZyB8fCB2ZXJpZmljYXRpb25TdGF0dXMgPT09ICJwZW5kaW5nIn0KICAgICAgICAgIC8+CiAgICAgICAgICA8cCBjbGFzc05hbWU9InRleHQteHMgdGV4dC1tdXRlZC1mb3JlZ3JvdW5kIj5XZeKAmWxsIHNlbmQgYW4gU1RLIHB1c2ggdG8gdGhpcyBudW1iZXIgZm9yIHBhaWQgb3B0aW9ucy48L3A+CiAgICAgICAgPC9kaXY+CgogICAgICAgIHt2ZXJpZmljYXRpb25TdGF0dXMgPT09ICJwZW5kaW5nIiAmJiBwZW5kaW5nUGF5bWVudElkICYmICgKICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSJyb3VuZGVkLWxnIGJvcmRlciBwLTMgdGV4dC1zbSB0ZXh0LW11dGVkLWZvcmVncm91bmQiPgogICAgICAgICAgICBXYWl0aW5nIGZvciBwYXltZW50IGNvbmZpcm1hdGlvbuKApgogICAgICAgICAgICA8QnV0dG9uCiAgICAgICAgICAgICAgdHlwZT0iYnV0dG9uIgogICAgICAgICAgICAgIHZhcmlhbnQ9Im91dGxpbmUiCiAgICAgICAgICAgICAgc2l6ZT0ic20iCiAgICAgICAgICAgICAgY2xhc3NOYW1lPSJtdC0yIHctZnVsbCIKICAgICAgICAgICAgICBvbkNsaWNrPXthc3luYyAoKSA9PiB7CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCByZWZyZXNoUGF5bWVudFN0YXR1cyh7CiAgICAgICAgICAgICAgICAgICAgcGF5bWVudElkOiBwZW5kaW5nUGF5bWVudElkIGFzIGFueSwKICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGN1cnJlbnRVc2VyPy5faWQgYXMgYW55LAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgaWYgKHJlcy5zdGF0dXMgPT09ICJjb21wbGV0ZWQiKSB7CiAgICAgICAgICAgICAgICAgICAgdG9hc3QoeyB0aXRsZTogIlBheW1lbnQgY29uZmlybWVkIiwgZGVzY3JpcHRpb246ICJZb3UgY2FuIHByb2NlZWQuIiB9KTsKICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZXMuc3RhdHVzID09PSAiZmFpbGVkIikgewogICAgICAgICAgICAgICAgICAgIHRvYXN0KHsgdGl0bGU6ICJQYXltZW50IGZhaWxlZCIsIGRlc2NyaXB0aW9uOiAiVHJhbnNhY3Rpb24gZmFpbGVkIG9yIHRpbWVkIG91dC4iIH0pOwogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHRvYXN0KHsgdGl0bGU6ICJTdGlsbCBwZW5kaW5nIiwgZGVzY3JpcHRpb246ICJQbGVhc2UgY29tcGxldGUgdGhlIFNUSyBwcm9tcHQgb24geW91ciBwaG9uZS4iIH0pOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGNhdGNoIChlOiBhbnkpIHsKICAgICAgICAgICAgICAgICAgdG9hc3QoeyB0aXRsZTogIkNvdWxkIG5vdCByZWZyZXNoIiwgZGVzY3JpcHRpb246IGU/Lm1lc3NhZ2UgPz8gIlRyeSBhZ2FpbiIgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfX0KICAgICAgICAgICAgPgogICAgICAgICAgICAgIENoZWNrIHBheW1lbnQgc3RhdHVzCiAgICAgICAgICAgIDwvQnV0dG9uPgogICAgICAgICAgPC9kaXY+CiAgICAgICAgKX0KCiAgICAgICAgPGRpdiBjbGFzc05hbWU9InNwYWNlLXktMyBweS00Ij4KICAgICAgICAgIHsvKiBGcmVlIFRyaWFsIE9wdGlvbiAqL30KICAgICAgICAgIHtzaG93RnJlZVRyaWFsICYmICgKICAgICAgICAgICAgPENhcmQgY2xhc3NOYW1lPSJib3JkZXItMiBib3JkZXItcHJpbWFyeSBiZy1wcmltYXJ5LzUiPgogICAgICAgICAgICAgIDxDYXJkQ29udGVudCBjbGFzc05hbWU9InAtNCI+CiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0iZmxleCBpdGVtcy1zdGFydCBqdXN0aWZ5LWJldHdlZW4iPgogICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0iZmxleC0xIj4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0iZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTIgbWItMiI+CiAgICAgICAgICAgICAgICAgICAgICA8QmFkZ2UgdmFyaWFudD0iZGVmYXVsdCIgY2xhc3NOYW1lPSJiZy1wcmltYXJ5Ij4KICAgICAgICAgICAgICAgICAgICAgICAgPFNwYXJrbGVzIGNsYXNzTmFtZT0iaC0zIHctMyBtci0xIiAvPgogICAgICAgICAgICAgICAgICAgICAgICBGcmVlIFRyaWFsCiAgICAgICAgICAgICAgICAgICAgICA8L0JhZGdlPgogICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPSJ0ZXh0LXNtIHRleHQtbXV0ZWQtZm9yZWdyb3VuZCI+CiAgICAgICAgICAgICAgICAgICAgICAgIHtmcmVlVHJpYWxTdGF0dXMucHJvZmlsZVVubG9ja3NSZW1haW5pbmd9IGxlZnQKICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj4KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9InRleHQtc20gZm9udC1tZWRpdW0gbWItMSI+VXNlIEZyZWUgVHJpYWwgVW5sb2NrPC9wPgogICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT0idGV4dC14cyB0ZXh0LW11dGVkLWZvcmVncm91bmQiPgogICAgICAgICAgICAgICAgICAgICAgWW91IGhhdmUge2ZyZWVUcmlhbFN0YXR1cy5wcm9maWxlVW5sb2Nrc1JlbWFpbmluZ30gZnJlZSB1bmxvY2tzIHJlbWFpbmluZwogICAgICAgICAgICAgICAgICAgIDwvcD4KICAgICAgICAgICAgICAgICAgICB7ZnJlZVRyaWFsU3RhdHVzLnRyaWFsRW5kcyAmJiAoCiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0iZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTEgbXQtMiB0ZXh0LXhzIHRleHQtbXV0ZWQtZm9yZWdyb3VuZCI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxDbG9jayBjbGFzc05hbWU9ImgtMyB3LTMiIC8+CiAgICAgICAgICAgICAgICAgICAgICAgIFRyaWFsIGVuZHMgaW4ge01hdGguY2VpbCgoZnJlZVRyaWFsU3RhdHVzLnRyaWFsRW5kcyAtIERhdGUubm93KCkpIC8gKDYwICogNjAgKiAxMDAwKSl9IGhvdXJzCiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICApfQogICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgPEJ1dHRvbgogICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IGhhbmRsZVVubG9jaygidHJpYWwiKX0KICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17aXNVbmxvY2tpbmd9CiAgICAgICAgICAgICAgICAgICAgc2l6ZT0ic20iCiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPSJtbC00IgogICAgICAgICAgICAgICAgICA+CiAgICAgICAgICAgICAgICAgICAge2lzVW5sb2NraW5nICYmIHNlbGVjdGVkT3B0aW9uID09PSAidHJpYWwiID8gKAogICAgICAgICAgICAgICAgICAgICAgPExvYWRlcjIgY2xhc3NOYW1lPSJoLTQgdy00IGFuaW1hdGUtc3BpbiIgLz4KICAgICAgICAgICAgICAgICAgICApIDogKAogICAgICAgICAgICAgICAgICAgICAgIlVubG9jayBGcmVlIgogICAgICAgICAgICAgICAgICAgICl9CiAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgPC9DYXJkQ29udGVudD4KICAgICAgICAgICAgPC9DYXJkPgogICAgICAgICAgKX0KCiAgICAgICAgICB7LyogUHJlbWl1bSBTdWJzY3JpcHRpb24gT3B0aW9ucyAqL30KICAgICAgICAgIDxDYXJkIGNsYXNzTmFtZT0iYm9yZGVyLW9yYW5nZS0yMDAgYmctb3JhbmdlLTUwIj4KICAgICAgICAgICAgPENhcmRDb250ZW50IGNsYXNzTmFtZT0icC00Ij4KICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0ibWItMyI+CiAgICAgICAgICAgICAgICA8QmFkZ2UgdmFyaWFudD0ic2Vjb25kYXJ5IiBjbGFzc05hbWU9ImJnLW9yYW5nZS0xMDAgdGV4dC1vcmFuZ2UtNzAwIG1iLTIiPgogICAgICAgICAgICAgICAgICA8U3BhcmtsZXMgY2xhc3NOYW1lPSJoLTMgdy0zIG1yLTEiIC8+CiAgICAgICAgICAgICAgICAgIE1vc3QgUG9wdWxhcgogICAgICAgICAgICAgICAgPC9CYWRnZT4KICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT0idGV4dC1zbSBmb250LXNlbWlib2xkIj5HbyBQcmVtaXVtIC0gVW5saW1pdGVkIFVubG9ja3M8L3A+CiAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9InRleHQteHMgdGV4dC1tdXRlZC1mb3JlZ3JvdW5kIG10LTEiPgogICAgICAgICAgICAgICAgICBVbmxvY2sgdW5saW1pdGVkIHByb2ZpbGVzICsgYWxsIHByZW1pdW0gZmVhdHVyZXMKICAgICAgICAgICAgICAgIDwvcD4KICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0ic3BhY2UteS0yIj4KICAgICAgICAgICAgICAgIDxCdXR0b24KICAgICAgICAgICAgICAgICAgdmFyaWFudD0ib3V0bGluZSIKICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPSJ3LWZ1bGwganVzdGlmeS1iZXR3ZWVuIgogICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBoYW5kbGVVbmxvY2soIndlZWtseSIpfQogICAgICAgICAgICAgICAgICBkaXNhYmxlZD17aXNVbmxvY2tpbmd9CiAgICAgICAgICAgICAgICA+CiAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT0idGV4dC1zbSI+CiAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPSJmb250LXNlbWlib2xkIj5LRVMgMTAwPC9zcGFuPiAvIHdlZWsKICAgICAgICAgICAgICAgICAgPC9zcGFuPgogICAgICAgICAgICAgICAgICB7aXNVbmxvY2tpbmcgJiYgc2VsZWN0ZWRPcHRpb24gPT09ICJ3ZWVrbHkiID8gKAogICAgICAgICAgICAgICAgICAgIDxMb2FkZXIyIGNsYXNzTmFtZT0iaC00IHctNCBhbmltYXRlLXNwaW4iIC8+CiAgICAgICAgICAgICAgICAgICkgOiAoCiAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPSJ0ZXh0LXhzIHRleHQtbXV0ZWQtZm9yZWdyb3VuZCI+fktFUyAxNC9kYXk8L3NwYW4+CiAgICAgICAgICAgICAgICAgICl9CiAgICAgICAgICAgICAgICA8L0J1dHRvbj4KICAgICAgICAgICAgICAgIDxCdXR0b24KICAgICAgICAgICAgICAgICAgdmFyaWFudD0ib3V0bGluZSIKICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPSJ3LWZ1bGwganVzdGlmeS1iZXR3ZWVuIgogICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBoYW5kbGVVbmxvY2soIm1vbnRobHkiKX0KICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9e2lzVW5sb2NraW5nfQogICAgICAgICAgICAgICAgPgogICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9InRleHQtc20iPgogICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT0iZm9udC1zZW1pYm9sZCI+S0VTIDM1MDwvc3Bhbj4gLyBtb250aAogICAgICAgICAgICAgICAgICA8L3NwYW4+CiAgICAgICAgICAgICAgICAgIHtpc1VubG9ja2luZyAmJiBzZWxlY3RlZE9wdGlvbiA9PT0gIm1vbnRobHkiID8gKAogICAgICAgICAgICAgICAgICAgIDxMb2FkZXIyIGNsYXNzTmFtZT0iaC00IHctNCBhbmltYXRlLXNwaW4iIC8+CiAgICAgICAgICAgICAgICAgICkgOiAoCiAgICAgICAgICAgICAgICAgICAgPEJhZGdlIHZhcmlhbnQ9InNlY29uZGFyeSIgY2xhc3NOYW1lPSJ0ZXh0LXhzIj5TYXZlIDEyJTwvQmFkZ2U+CiAgICAgICAgICAgICAgICAgICl9CiAgICAgICAgICAgICAgICA8L0J1dHRvbj4KICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPC9DYXJkQ29udGVudD4KICAgICAgICAgIDwvQ2FyZD4KCiAgICAgICAgICB7LyogU2luZ2xlIFVubG9jayBPcHRpb24gKi99CiAgICAgICAgICA8Q2FyZD4KICAgICAgICAgICAgPENhcmRDb250ZW50IGNsYXNzTmFtZT0icC00Ij4KICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0iZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1iZXR3ZWVuIj4KICAgICAgICAgICAgICAgIDxkaXY+CiAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT0idGV4dC1zbSBmb250LW1lZGl1bSBtYi0xIj5VbmxvY2sgT25jZTwvcD4KICAgICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPSJ0ZXh0LXhzIHRleHQtbXV0ZWQtZm9yZWdyb3VuZCI+CiAgICAgICAgICAgICAgICAgICAgUGF5IHBlciBwcm9maWxlIHVubG9jawogICAgICAgICAgICAgICAgICA8L3A+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgIDxCdXR0b24KICAgICAgICAgICAgICAgICAgdmFyaWFudD0ib3V0bGluZSIKICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gaGFuZGxlVW5sb2NrKCJvbmNlIil9CiAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXtpc1VubG9ja2luZ30KICAgICAgICAgICAgICAgICAgc2l6ZT0ic20iCiAgICAgICAgICAgICAgICA+CiAgICAgICAgICAgICAgICAgIHtpc1VubG9ja2luZyAmJiBzZWxlY3RlZE9wdGlvbiA9PT0gIm9uY2UiID8gKAogICAgICAgICAgICAgICAgICAgIDxMb2FkZXIyIGNsYXNzTmFtZT0iaC00IHctNCBhbmltYXRlLXNwaW4gbXItMiIgLz4KICAgICAgICAgICAgICAgICAgKSA6ICgKICAgICAgICAgICAgICAgICAgICA8Q3JlZGl0Q2FyZCBjbGFzc05hbWU9ImgtNCB3LTQgbXItMiIgLz4KICAgICAgICAgICAgICAgICAgKX0KICAgICAgICAgICAgICAgICAgS0VTIDEwCiAgICAgICAgICAgICAgICA8L0J1dHRvbj4KICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPC9DYXJkQ29udGVudD4KICAgICAgICAgIDwvQ2FyZD4KICAgICAgICA8L2Rpdj4KCiAgICAgICAgPGRpdiBjbGFzc05hbWU9InRleHQteHMgdGV4dC1jZW50ZXIgdGV4dC1tdXRlZC1mb3JlZ3JvdW5kIj4KICAgICAgICAgIEFsbCB1bmxvY2tlZCBwcm9maWxlcyByZW1haW4gYWNjZXNzaWJsZSBmb3JldmVyCiAgICAgICAgPC9kaXY+CiAgICAgIDwvRGlhbG9nQ29udGVudD4KICAgIDwvRGlhbG9nPgogICk7Cn0K"}