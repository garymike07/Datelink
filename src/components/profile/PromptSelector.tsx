{"data":"aW1wb3J0IHsgdXNlU3RhdGUsIHVzZUVmZmVjdCB9IGZyb20gInJlYWN0IjsNCmltcG9ydCB7IHVzZVF1ZXJ5LCB1c2VNdXRhdGlvbiB9IGZyb20gImNvbnZleC9yZWFjdCI7DQppbXBvcnQgeyBhcGkgfSBmcm9tICIuLi8uLi8uLi9jb252ZXgvX2dlbmVyYXRlZC9hcGkiOw0KaW1wb3J0IHsgQ2FyZCB9IGZyb20gIkAvY29tcG9uZW50cy91aS9jYXJkIjsNCmltcG9ydCB7IEJ1dHRvbiB9IGZyb20gIkAvY29tcG9uZW50cy91aS9idXR0b24iOw0KaW1wb3J0IHsgVGV4dGFyZWEgfSBmcm9tICJAL2NvbXBvbmVudHMvdWkvdGV4dGFyZWEiOw0KaW1wb3J0IHsgQmFkZ2UgfSBmcm9tICJAL2NvbXBvbmVudHMvdWkvYmFkZ2UiOw0KaW1wb3J0IHsgWCwgUGx1cyB9IGZyb20gImx1Y2lkZS1yZWFjdCI7DQppbXBvcnQgeyB0b2FzdCB9IGZyb20gInNvbm5lciI7DQppbXBvcnQgeyBJZCB9IGZyb20gIi4uLy4uLy4uL2NvbnZleC9fZ2VuZXJhdGVkL2RhdGFNb2RlbCI7DQoNCmludGVyZmFjZSBQcm9tcHRTZWxlY3RvclByb3BzIHsNCiAgICB1c2VySWQ6IElkPCJ1c2VycyI+Ow0KICAgIG9uVXBkYXRlPzogKCkgPT4gdm9pZDsNCn0NCg0KY29uc3QgUHJvbXB0U2VsZWN0b3IgPSAoeyB1c2VySWQsIG9uVXBkYXRlIH06IFByb21wdFNlbGVjdG9yUHJvcHMpID0+IHsNCiAgICBjb25zdCBbc2VsZWN0ZWRQcm9tcHRzLCBzZXRTZWxlY3RlZFByb21wdHNdID0gdXNlU3RhdGU8YW55W10+KFtdKTsNCiAgICBjb25zdCBbYW5zd2Vycywgc2V0QW5zd2Vyc10gPSB1c2VTdGF0ZTxSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+Pih7fSk7DQogICAgY29uc3QgW3Nob3dQcm9tcHRMaWJyYXJ5LCBzZXRTaG93UHJvbXB0TGlicmFyeV0gPSB1c2VTdGF0ZShmYWxzZSk7DQoNCiAgICBjb25zdCBwcm9tcHRzID0gdXNlUXVlcnkoYXBpLnByb21wdHMuZ2V0QWN0aXZlUHJvbXB0cyk7DQogICAgY29uc3QgdXNlckFuc3dlcnMgPSB1c2VRdWVyeShhcGkucHJvbXB0cy5nZXRVc2VyUHJvbXB0QW5zd2VycywgeyB1c2VySWQgfSk7DQogICAgY29uc3QgYWRkQW5zd2VyID0gdXNlTXV0YXRpb24oYXBpLnByb21wdHMuYWRkUHJvbXB0QW5zd2VyKTsNCiAgICBjb25zdCB1cGRhdGVBbnN3ZXIgPSB1c2VNdXRhdGlvbihhcGkucHJvbXB0cy51cGRhdGVQcm9tcHRBbnN3ZXIpOw0KICAgIGNvbnN0IGRlbGV0ZUFuc3dlciA9IHVzZU11dGF0aW9uKGFwaS5wcm9tcHRzLmRlbGV0ZVByb21wdEFuc3dlcik7DQoNCiAgICB1c2VFZmZlY3QoKCkgPT4gew0KICAgICAgICBpZiAodXNlckFuc3dlcnMpIHsNCiAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkID0gdXNlckFuc3dlcnMubWFwKChhKSA9PiAoew0KICAgICAgICAgICAgICAgIF9pZDogYS5wcm9tcHRJZCwNCiAgICAgICAgICAgICAgICB0ZXh0OiBhLnByb21wdFRleHQsDQogICAgICAgICAgICAgICAgY2F0ZWdvcnk6IGEucHJvbXB0Q2F0ZWdvcnksDQogICAgICAgICAgICAgICAgYW5zd2VySWQ6IGEuX2lkLA0KICAgICAgICAgICAgfSkpOw0KICAgICAgICAgICAgc2V0U2VsZWN0ZWRQcm9tcHRzKHNlbGVjdGVkKTsNCg0KICAgICAgICAgICAgY29uc3QgYW5zd2VyTWFwOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge307DQogICAgICAgICAgICB1c2VyQW5zd2Vycy5mb3JFYWNoKChhKSA9PiB7DQogICAgICAgICAgICAgICAgYW5zd2VyTWFwW2EucHJvbXB0SWRdID0gYS5hbnN3ZXI7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIHNldEFuc3dlcnMoYW5zd2VyTWFwKTsNCiAgICAgICAgfQ0KICAgIH0sIFt1c2VyQW5zd2Vyc10pOw0KDQogICAgY29uc3QgaGFuZGxlU2VsZWN0UHJvbXB0ID0gKHByb21wdDogYW55KSA9PiB7DQogICAgICAgIGlmIChzZWxlY3RlZFByb21wdHMubGVuZ3RoID49IDUpIHsNCiAgICAgICAgICAgIHRvYXN0LmVycm9yKCJZb3UgY2FuIHNlbGVjdCB1cCB0byA1IHByb21wdHMiKTsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChzZWxlY3RlZFByb21wdHMuZmluZCgocCkgPT4gcC5faWQgPT09IHByb21wdC5faWQpKSB7DQogICAgICAgICAgICB0b2FzdC5lcnJvcigiWW91J3ZlIGFscmVhZHkgc2VsZWN0ZWQgdGhpcyBwcm9tcHQiKTsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KDQogICAgICAgIHNldFNlbGVjdGVkUHJvbXB0cyhbLi4uc2VsZWN0ZWRQcm9tcHRzLCBwcm9tcHRdKTsNCiAgICAgICAgc2V0U2hvd1Byb21wdExpYnJhcnkoZmFsc2UpOw0KICAgIH07DQoNCiAgICBjb25zdCBoYW5kbGVSZW1vdmVQcm9tcHQgPSBhc3luYyAocHJvbXB0OiBhbnkpID0+IHsNCiAgICAgICAgaWYgKHByb21wdC5hbnN3ZXJJZCkgew0KICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICBhd2FpdCBkZWxldGVBbnN3ZXIoeyBhbnN3ZXJJZDogcHJvbXB0LmFuc3dlcklkLCB1c2VySWQgfSk7DQogICAgICAgICAgICAgICAgdG9hc3Quc3VjY2VzcygiUHJvbXB0IHJlbW92ZWQiKTsNCiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgICAgICAgICAgdG9hc3QuZXJyb3IoIkZhaWxlZCB0byByZW1vdmUgcHJvbXB0Iik7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgc2V0U2VsZWN0ZWRQcm9tcHRzKHNlbGVjdGVkUHJvbXB0cy5maWx0ZXIoKHApID0+IHAuX2lkICE9PSBwcm9tcHQuX2lkKSk7DQogICAgICAgIGNvbnN0IG5ld0Fuc3dlcnMgPSB7IC4uLmFuc3dlcnMgfTsNCiAgICAgICAgZGVsZXRlIG5ld0Fuc3dlcnNbcHJvbXB0Ll9pZF07DQogICAgICAgIHNldEFuc3dlcnMobmV3QW5zd2Vycyk7DQogICAgfTsNCg0KICAgIGNvbnN0IGhhbmRsZVNhdmVBbnN3ZXIgPSBhc3luYyAocHJvbXB0SWQ6IHN0cmluZykgPT4gew0KICAgICAgICBjb25zdCBhbnN3ZXIgPSBhbnN3ZXJzW3Byb21wdElkXTsNCiAgICAgICAgaWYgKCFhbnN3ZXIgfHwgYW5zd2VyLnRyaW0oKS5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICAgIHRvYXN0LmVycm9yKCJQbGVhc2Ugd3JpdGUgYW4gYW5zd2VyIik7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoYW5zd2VyLmxlbmd0aCA+IDMwMCkgew0KICAgICAgICAgICAgdG9hc3QuZXJyb3IoIkFuc3dlciBtdXN0IGJlIDMwMCBjaGFyYWN0ZXJzIG9yIGxlc3MiKTsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KDQogICAgICAgIHRyeSB7DQogICAgICAgICAgICBjb25zdCBwcm9tcHQgPSBzZWxlY3RlZFByb21wdHMuZmluZCgocCkgPT4gcC5faWQgPT09IHByb21wdElkKTsNCiAgICAgICAgICAgIGNvbnN0IG9yZGVyID0gc2VsZWN0ZWRQcm9tcHRzLmluZGV4T2YocHJvbXB0KTsNCg0KICAgICAgICAgICAgYXdhaXQgYWRkQW5zd2VyKHsNCiAgICAgICAgICAgICAgICB1c2VySWQsDQogICAgICAgICAgICAgICAgcHJvbXB0SWQ6IHByb21wdElkIGFzIElkPCJwcm9tcHRzIj4sDQogICAgICAgICAgICAgICAgYW5zd2VyLA0KICAgICAgICAgICAgICAgIG9yZGVyLA0KICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgIHRvYXN0LnN1Y2Nlc3MoIkFuc3dlciBzYXZlZCEiKTsNCiAgICAgICAgICAgIG9uVXBkYXRlPy4oKTsNCiAgICAgICAgfSBjYXRjaCAoZXJyb3I6IGFueSkgew0KICAgICAgICAgICAgdG9hc3QuZXJyb3IoZXJyb3IubWVzc2FnZSB8fCAiRmFpbGVkIHRvIHNhdmUgYW5zd2VyIik7DQogICAgICAgIH0NCiAgICB9Ow0KDQogICAgY29uc3QgcHJvbXB0c0J5Q2F0ZWdvcnkgPSBwcm9tcHRzPy5yZWR1Y2UoKGFjYzogYW55LCBwcm9tcHQ6IGFueSkgPT4gew0KICAgICAgICBpZiAoIWFjY1twcm9tcHQuY2F0ZWdvcnldKSB7DQogICAgICAgICAgICBhY2NbcHJvbXB0LmNhdGVnb3J5XSA9IFtdOw0KICAgICAgICB9DQogICAgICAgIGFjY1twcm9tcHQuY2F0ZWdvcnldLnB1c2gocHJvbXB0KTsNCiAgICAgICAgcmV0dXJuIGFjYzsNCiAgICB9LCB7fSk7DQoNCiAgICByZXR1cm4gKA0KICAgICAgICA8ZGl2IGNsYXNzTmFtZT0ic3BhY2UteS02Ij4NCiAgICAgICAgICAgIDxkaXY+DQogICAgICAgICAgICAgICAgPGgzIGNsYXNzTmFtZT0idGV4dC1sZyBmb250LXNlbWlib2xkIG1iLTIiPlByb2ZpbGUgUHJvbXB0czwvaDM+DQogICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPSJ0ZXh0LXNtIHRleHQtbXV0ZWQtZm9yZWdyb3VuZCBtYi00Ij4NCiAgICAgICAgICAgICAgICAgICAgQW5zd2VyIDMtNSBwcm9tcHRzIHRvIGhlbHAgb3RoZXJzIGdldCB0byBrbm93IHlvdSBiZXR0ZXINCiAgICAgICAgICAgICAgICA8L3A+DQogICAgICAgICAgICA8L2Rpdj4NCg0KICAgICAgICAgICAgey8qIFNlbGVjdGVkIFByb21wdHMgKi99DQogICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0ic3BhY2UteS00Ij4NCiAgICAgICAgICAgICAgICB7c2VsZWN0ZWRQcm9tcHRzLm1hcCgocHJvbXB0LCBpbmRleCkgPT4gKA0KICAgICAgICAgICAgICAgICAgICA8Q2FyZCBrZXk9e3Byb21wdC5faWR9IGNsYXNzTmFtZT0icC00Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSJmbGV4IGp1c3RpZnktYmV0d2VlbiBpdGVtcy1zdGFydCBtYi0zIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0iZmxleC0xIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEJhZGdlIHZhcmlhbnQ9InNlY29uZGFyeSIgY2xhc3NOYW1lPSJtYi0yIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtwcm9tcHQuY2F0ZWdvcnl9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvQmFkZ2U+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxoNCBjbGFzc05hbWU9ImZvbnQtbWVkaXVtIj57cHJvbXB0LnRleHR9PC9oND4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QnV0dG9uDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnQ9Imdob3N0Ig0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplPSJzbSINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gaGFuZGxlUmVtb3ZlUHJvbXB0KHByb21wdCl9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8WCBjbGFzc05hbWU9InctNCBoLTQiIC8+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+DQogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCg0KICAgICAgICAgICAgICAgICAgICAgICAgPFRleHRhcmVhDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9IllvdXIgYW5zd2VyLi4uIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXthbnN3ZXJzW3Byb21wdC5faWRdIHx8ICIifQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXsoZSkgPT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0QW5zd2Vycyh7IC4uLmFuc3dlcnMsIFtwcm9tcHQuX2lkXTogZS50YXJnZXQudmFsdWUgfSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgb25CbHVyPXsoKSA9PiBoYW5kbGVTYXZlQW5zd2VyKHByb21wdC5faWQpfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heExlbmd0aD17MzAwfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT0ibWItMiINCiAgICAgICAgICAgICAgICAgICAgICAgIC8+DQogICAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9InRleHQteHMgdGV4dC1tdXRlZC1mb3JlZ3JvdW5kIHRleHQtcmlnaHQiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsoYW5zd2Vyc1twcm9tcHQuX2lkXSB8fCAiIikubGVuZ3RofS8zMDANCiAgICAgICAgICAgICAgICAgICAgICAgIDwvcD4NCiAgICAgICAgICAgICAgICAgICAgPC9DYXJkPg0KICAgICAgICAgICAgICAgICkpfQ0KICAgICAgICAgICAgPC9kaXY+DQoNCiAgICAgICAgICAgIHsvKiBBZGQgUHJvbXB0IEJ1dHRvbiAqL30NCiAgICAgICAgICAgIHtzZWxlY3RlZFByb21wdHMubGVuZ3RoIDwgNSAmJiAoDQogICAgICAgICAgICAgICAgPEJ1dHRvbg0KICAgICAgICAgICAgICAgICAgICB2YXJpYW50PSJvdXRsaW5lIg0KICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9InctZnVsbCINCiAgICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gc2V0U2hvd1Byb21wdExpYnJhcnkoIXNob3dQcm9tcHRMaWJyYXJ5KX0NCiAgICAgICAgICAgICAgICA+DQogICAgICAgICAgICAgICAgICAgIDxQbHVzIGNsYXNzTmFtZT0idy00IGgtNCBtci0yIiAvPg0KICAgICAgICAgICAgICAgICAgICBBZGQgUHJvbXB0DQogICAgICAgICAgICAgICAgPC9CdXR0b24+DQogICAgICAgICAgICApfQ0KDQogICAgICAgICAgICB7LyogUHJvbXB0IExpYnJhcnkgKi99DQogICAgICAgICAgICB7c2hvd1Byb21wdExpYnJhcnkgJiYgKA0KICAgICAgICAgICAgICAgIDxDYXJkIGNsYXNzTmFtZT0icC00Ij4NCiAgICAgICAgICAgICAgICAgICAgPGg0IGNsYXNzTmFtZT0iZm9udC1zZW1pYm9sZCBtYi00Ij5DaG9vc2UgYSBQcm9tcHQ8L2g0Pg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0ic3BhY2UteS00Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgIHtwcm9tcHRzQnlDYXRlZ29yeSAmJg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5lbnRyaWVzKHByb21wdHNCeUNhdGVnb3J5KS5tYXAoKFtjYXRlZ29yeSwgY2F0ZWdvcnlQcm9tcHRzXTogW3N0cmluZywgYW55XSkgPT4gKA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGtleT17Y2F0ZWdvcnl9Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGg1IGNsYXNzTmFtZT0idGV4dC1zbSBmb250LW1lZGl1bSB0ZXh0LW11dGVkLWZvcmVncm91bmQgbWItMiBjYXBpdGFsaXplIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Y2F0ZWdvcnl9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2g1Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9InNwYWNlLXktMiI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2NhdGVnb3J5UHJvbXB0cy5tYXAoKHByb21wdDogYW55KSA9PiAoDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxCdXR0b24NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleT17cHJvbXB0Ll9pZH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnQ9Imdob3N0Ig0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPSJ3LWZ1bGwganVzdGlmeS1zdGFydCB0ZXh0LWxlZnQgaC1hdXRvIHB5LTMiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBoYW5kbGVTZWxlY3RQcm9tcHQocHJvbXB0KX0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXtzZWxlY3RlZFByb21wdHMuZmluZCgocCkgPT4gcC5faWQgPT09IHByb21wdC5faWQpfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7cHJvbXB0LnRleHR9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkpfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICkpfQ0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICA8L0NhcmQ+DQogICAgICAgICAgICApfQ0KDQogICAgICAgICAgICB7c2VsZWN0ZWRQcm9tcHRzLmxlbmd0aCA8IDMgJiYgKA0KICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT0idGV4dC1zbSB0ZXh0LWFtYmVyLTYwMCI+DQogICAgICAgICAgICAgICAgICAgIOKaoO+4jyBBZGQgYXQgbGVhc3QgMyBwcm9tcHRzIHRvIGluY3JlYXNlIHlvdXIgcHJvZmlsZSBjb21wbGV0ZW5lc3MNCiAgICAgICAgICAgICAgICA8L3A+DQogICAgICAgICAgICApfQ0KICAgICAgICA8L2Rpdj4NCiAgICApOw0KfTsNCg0KZXhwb3J0IGRlZmF1bHQgUHJvbXB0U2VsZWN0b3I7DQo="}