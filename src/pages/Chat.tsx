{"data":"aW1wb3J0IHsgdXNlRWZmZWN0LCB1c2VNZW1vLCB1c2VSZWYsIHVzZVN0YXRlIH0gZnJvbSAicmVhY3QiOwppbXBvcnQgeyB1c2VBdXRoIH0gZnJvbSAiQC9jb250ZXh0cy9BdXRoQ29udGV4dCI7CmltcG9ydCB7IHVzZVBhcmFtcywgdXNlTmF2aWdhdGUgfSBmcm9tICJyZWFjdC1yb3V0ZXItZG9tIjsKaW1wb3J0IHsgdXNlUXVlcnksIHVzZU11dGF0aW9uIH0gZnJvbSAiY29udmV4L3JlYWN0IjsKaW1wb3J0IHsgYXBpIH0gZnJvbSAiLi4vLi4vY29udmV4L19nZW5lcmF0ZWQvYXBpIjsKaW1wb3J0IHsgQnV0dG9uIH0gZnJvbSAiQC9jb21wb25lbnRzL3VpL2J1dHRvbiI7CmltcG9ydCB7IFRleHRhcmVhIH0gZnJvbSAiQC9jb21wb25lbnRzL3VpL3RleHRhcmVhIjsKaW1wb3J0IHsgQ2FyZCB9IGZyb20gIkAvY29tcG9uZW50cy91aS9jYXJkIjsKaW1wb3J0IHsgQXJyb3dMZWZ0LCBDaGVjaywgQ2hlY2tDaGVjaywgQ2xvY2ssIEhlYXJ0LCBJbWFnZSBhcyBJbWFnZUljb24sIE1vcmVWZXJ0aWNhbCwgU2VuZCwgVHJhc2gyLCBTbWlsZSwgUGFwZXJjbGlwLCBEb3dubG9hZCB9IGZyb20gImx1Y2lkZS1yZWFjdCI7CmltcG9ydCB7IHRvYXN0IH0gZnJvbSAic29ubmVyIjsKaW1wb3J0IHsgZm9ybWF0LCBmb3JtYXREaXN0YW5jZVRvTm93IH0gZnJvbSAiZGF0ZS1mbnMiOwppbXBvcnQgewogICAgRHJvcGRvd25NZW51LAogICAgRHJvcGRvd25NZW51Q29udGVudCwKICAgIERyb3Bkb3duTWVudUl0ZW0sCiAgICBEcm9wZG93bk1lbnVUcmlnZ2VyLAp9IGZyb20gIkAvY29tcG9uZW50cy91aS9kcm9wZG93bi1tZW51IjsKaW1wb3J0IHsgUG9wb3ZlciwgUG9wb3ZlckNvbnRlbnQsIFBvcG92ZXJUcmlnZ2VyIH0gZnJvbSAiQC9jb21wb25lbnRzL3VpL3BvcG92ZXIiOwppbXBvcnQgVHlwaW5nSW5kaWNhdG9yIGZyb20gIkAvY29tcG9uZW50cy9tZXNzYWdlcy9UeXBpbmdJbmRpY2F0b3IiOwppbXBvcnQgTWVzc2FnZVJlYWN0aW9ucyBmcm9tICJAL2NvbXBvbmVudHMvbWVzc2FnZXMvTWVzc2FnZVJlYWN0aW9ucyI7CmltcG9ydCBJY2VicmVha2VyU3VnZ2VzdGlvbnMgZnJvbSAiQC9jb21wb25lbnRzL21lc3NhZ2VzL0ljZWJyZWFrZXJTdWdnZXN0aW9ucyI7CmltcG9ydCB7IEdpZlBpY2tlciB9IGZyb20gIkAvY29tcG9uZW50cy9tZXNzYWdlcy9HaWZQaWNrZXIiOwppbXBvcnQgeyBWb2ljZU1lc3NhZ2UgfSBmcm9tICJAL2NvbXBvbmVudHMvbWVzc2FnZXMvVm9pY2VNZXNzYWdlIjsKaW1wb3J0IHsgU2NoZWR1bGVNZXNzYWdlIH0gZnJvbSAiQC9jb21wb25lbnRzL21lc3NhZ2VzL1NjaGVkdWxlTWVzc2FnZSI7CmltcG9ydCB7IFNhZmV0eUJhbm5lciB9IGZyb20gIkAvY29tcG9uZW50cy9tZXNzYWdlcy9TYWZldHlCYW5uZXIiOwppbXBvcnQgeyBSZXBvcnRNb2RhbCB9IGZyb20gIkAvY29tcG9uZW50cy9zYWZldHkvUmVwb3J0TW9kYWwiOwppbXBvcnQgeyBDaGF0U2tlbGV0b24gfSBmcm9tICJAL2NvbXBvbmVudHMvdWkvc2tlbGV0b25zL0NoYXRTa2VsZXRvbiI7Cgpjb25zdCBDaGF0ID0gKCkgPT4gewogICAgY29uc3QgeyBtYXRjaElkIH0gPSB1c2VQYXJhbXMoKTsKICAgIGNvbnN0IG5hdmlnYXRlID0gdXNlTmF2aWdhdGUoKTsKICAgIGNvbnN0IFttZXNzYWdlLCBzZXRNZXNzYWdlXSA9IHVzZVN0YXRlKCIiKTsKICAgIGNvbnN0IG1lc3NhZ2VzRW5kUmVmID0gdXNlUmVmPEhUTUxEaXZFbGVtZW50PihudWxsKTsKICAgIGNvbnN0IFtnaWZPcGVuLCBzZXRHaWZPcGVuXSA9IHVzZVN0YXRlKGZhbHNlKTsKICAgIGNvbnN0IFtlbW9qaU9wZW4sIHNldEVtb2ppT3Blbl0gPSB1c2VTdGF0ZShmYWxzZSk7CiAgICBjb25zdCBpbnB1dFJlZiA9IHVzZVJlZjxIVE1MVGV4dEFyZWFFbGVtZW50PihudWxsKTsKICAgIGNvbnN0IFtzY2hlZHVsZU9wZW4sIHNldFNjaGVkdWxlT3Blbl0gPSB1c2VTdGF0ZShmYWxzZSk7CiAgICBjb25zdCBbc2FmZXR5RGlzbWlzc2VkLCBzZXRTYWZldHlEaXNtaXNzZWRdID0gdXNlU3RhdGUoZmFsc2UpOwogICAgY29uc3QgW3JlcG9ydE9wZW4sIHNldFJlcG9ydE9wZW5dID0gdXNlU3RhdGUoZmFsc2UpOwogICAgY29uc3QgcGhvdG9JbnB1dFJlZiA9IHVzZVJlZjxIVE1MSW5wdXRFbGVtZW50PihudWxsKTsKICAgIGNvbnN0IGZpbGVJbnB1dFJlZiA9IHVzZVJlZjxIVE1MSW5wdXRFbGVtZW50PihudWxsKTsKICAgIGNvbnN0IFt1cGxvYWRpbmdBdHRhY2htZW50LCBzZXRVcGxvYWRpbmdBdHRhY2htZW50XSA9IHVzZVN0YXRlKGZhbHNlKTsKICAgIGNvbnN0IFtwZW5kaW5nQXR0YWNobWVudHMsIHNldFBlbmRpbmdBdHRhY2htZW50c10gPSB1c2VTdGF0ZTxBcnJheTx7CiAgICAgICAgaWQ6IHN0cmluZzsKICAgICAgICBuYW1lOiBzdHJpbmc7CiAgICAgICAgdHlwZTogc3RyaW5nOwogICAgICAgIHNpemU6IG51bWJlcjsKICAgICAgICBwcmV2aWV3VXJsPzogc3RyaW5nOwogICAgfT4+KFtdKTsKICAgIGNvbnN0IFtpc0RyYWdnaW5nLCBzZXRJc0RyYWdnaW5nXSA9IHVzZVN0YXRlKGZhbHNlKTsKCiAgICBjb25zdCB7IHVzZXIsIGlzTG9hZGluZzogYXV0aExvYWRpbmcgfSA9IHVzZUF1dGgoKTsKICAgIAogICAgLy8gUmVkaXJlY3QgaWYgbm90IGF1dGhlbnRpY2F0ZWQKICAgIHVzZUVmZmVjdCgoKSA9PiB7CiAgICAgICAgaWYgKCFhdXRoTG9hZGluZyAmJiAhdXNlcikgewogICAgICAgICAgICBuYXZpZ2F0ZSgnL2xvZ2luJyk7CiAgICAgICAgfQogICAgfSwgW3VzZXIsIGF1dGhMb2FkaW5nLCBuYXZpZ2F0ZV0pOwoKICAgIGNvbnN0IHVzZXJJZCA9IHVzZXI/Ll9pZDsKCiAgICBjb25zdCBtYXRjaCA9IHVzZVF1ZXJ5KGFwaS5tYXRjaGluZy5nZXRNYXRjaEJ5SWQsIG1hdGNoSWQgJiYgdXNlcklkID8geyBtYXRjaElkOiBtYXRjaElkIGFzIGFueSwgdXNlcklkIH0gOiAic2tpcCIpOwogICAgY29uc3QgbWVzc2FnZXMgPSB1c2VRdWVyeShhcGkubWVzc2FnZXMuZ2V0Q29udmVyc2F0aW9uLCBtYXRjaElkICYmIHVzZXJJZCA/IHsgbWF0Y2hJZDogbWF0Y2hJZCBhcyBhbnksIHVzZXJJZCB9IDogInNraXAiKTsKICAgIGNvbnN0IHNlbmRNZXNzYWdlID0gdXNlTXV0YXRpb24oYXBpLm1lc3NhZ2VzLnNlbmRNZXNzYWdlKTsKICAgIGNvbnN0IGdlbmVyYXRlVXBsb2FkVXJsID0gdXNlTXV0YXRpb24oYXBpLmF0dGFjaG1lbnRzLmdlbmVyYXRlQXR0YWNobWVudFVwbG9hZFVybCk7CiAgICBjb25zdCBtYXJrQXNSZWFkID0gdXNlTXV0YXRpb24oYXBpLm1lc3NhZ2VzLm1hcmtBc1JlYWQpOwogICAgY29uc3Qgc2V0VHlwaW5nU3RhdHVzID0gdXNlTXV0YXRpb24oYXBpLm1lc3NhZ2VzLnNldFR5cGluZ1N0YXR1cyk7CiAgICBjb25zdCBkZWxldGVDaGF0ID0gdXNlTXV0YXRpb24oYXBpLm1lc3NhZ2VzLmRlbGV0ZUNoYXQpOwogICAgY29uc3QgZGVsZXRlTWVzc2FnZSA9IHVzZU11dGF0aW9uKGFwaS5tZXNzYWdlcy5kZWxldGVNZXNzYWdlKTsgICAgY29uc3QgYmxvY2tVc2VyID0gdXNlTXV0YXRpb24oYXBpLnNhZmV0eS5ibG9ja1VzZXIpOwogICAgY29uc3QgdXBkYXRlTGFzdFNlZW4gPSB1c2VNdXRhdGlvbihhcGkuYXV0aC51cGRhdGVMYXN0U2Vlbik7CiAgICBjb25zdCBzZW5kRHVlU2NoZWR1bGVkTWVzc2FnZXMgPSB1c2VNdXRhdGlvbihhcGkuc2NoZWR1bGVkTWVzc2FnZXMuc2VuZER1ZVNjaGVkdWxlZE1lc3NhZ2VzKTsKICAgIGNvbnN0IHJlYWN0aW9uc0J5TWVzc2FnZSA9IHVzZVF1ZXJ5KGFwaS5tZXNzYWdlcy5nZXRNZXNzYWdlUmVhY3Rpb25zLCBtYXRjaElkID8geyBtYXRjaElkOiBtYXRjaElkIGFzIGFueSB9IDogInNraXAiKTsKCiAgICAvLyBHZXQgcmVjZWl2ZXIncyBwcmVzZW5jZSBzdGF0dXMgZm9yIHRpY2sgbG9naWMKICAgIGNvbnN0IHJlY2VpdmVyUHJlc2VuY2UgPSB1c2VRdWVyeShhcGkucHJlc2VuY2UuZ2V0UHJlc2VuY2VTdGF0dXMsIAogICAgICAgIG1hdGNoPy51c2VySWQgJiYgdXNlcklkID8geyB0YXJnZXRVc2VySWQ6IG1hdGNoLnVzZXJJZCwgdmlld2VyVXNlcklkOiB1c2VySWQgfSA6ICJza2lwIgogICAgKTsKCiAgICBjb25zdCB1bmlxdWVNZXNzYWdlcyA9IHVzZU1lbW8oKCkgPT4gewogICAgICAgIGlmICghbWVzc2FnZXMpIHJldHVybiBbXSBhcyBhbnlbXTsKICAgICAgICBjb25zdCBzZWVuID0gbmV3IFNldDxzdHJpbmc+KCk7CiAgICAgICAgY29uc3Qgb3JkZXJlZDogYW55W10gPSBbXTsKICAgICAgICBmb3IgKGNvbnN0IG1zZyBvZiBtZXNzYWdlcyBhcyBhbnlbXSkgewogICAgICAgICAgICBpZiAoc2Vlbi5oYXMobXNnLl9pZCkpIGNvbnRpbnVlOwogICAgICAgICAgICBzZWVuLmFkZChtc2cuX2lkKTsKICAgICAgICAgICAgb3JkZXJlZC5wdXNoKG1zZyk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBvcmRlcmVkOwogICAgfSwgW21lc3NhZ2VzXSk7CiAgICBjb25zdCBlbnRpdGxlbWVudHMgPSB1c2VRdWVyeShhcGkuc3Vic2NyaXB0aW9ucy5nZXRNeUVudGl0bGVtZW50cywgdXNlcklkID8geyB1c2VySWQgfSA6ICJza2lwIik7CiAgICBjb25zdCByZWFkUmVjZWlwdHMgPSB1c2VRdWVyeSgKICAgICAgICBhcGkubWVzc2FnZXMuZ2V0UmVhZFJlY2VpcHRzLAogICAgICAgIG1hdGNoSWQgJiYgdXNlcklkICYmIGVudGl0bGVtZW50cz8uaXNQcmVtaXVtID8geyBtYXRjaElkOiBtYXRjaElkIGFzIGFueSwgdXNlcklkIH0gOiAic2tpcCIKICAgICk7CgogICAgY29uc3Qgc21hcnRSZXBsaWVzID0gdXNlTWVtbygoKSA9PiB7CiAgICAgICAgaWYgKCFtZXNzYWdlcyB8fCBtZXNzYWdlcy5sZW5ndGggPT09IDApIHJldHVybiBbXTsKICAgICAgICBjb25zdCBsYXN0ID0gKG1lc3NhZ2VzIGFzIGFueVtdKVttZXNzYWdlcy5sZW5ndGggLSAxXTsKICAgICAgICBpZiAoIWxhc3QgfHwgbGFzdC5zZW5kZXJJZCA9PT0gdXNlcklkKSByZXR1cm4gW107CiAgICAgICAgY29uc3QgdGV4dCA9IHR5cGVvZiBsYXN0LmJvZHkgPT09ICJzdHJpbmciID8gbGFzdC5ib2R5LnRvTG93ZXJDYXNlKCkgOiAiIjsKICAgICAgICBpZiAodGV4dC5pbmNsdWRlcygid2hlbiIpIHx8IHRleHQuaW5jbHVkZXMoInRpbWUiKSkgcmV0dXJuIFsiV2hhdCB0aW1lIHdvcmtzIGZvciB5b3U/IiwgIknigJltIGZyZWUgbGF0ZXIgdG9kYXkiLCAiVG9tb3Jyb3cgd29ya3MgZm9yIG1lIiwgIkxldOKAmXMgcGxhbiBpdCJdOyAKICAgICAgICBpZiAodGV4dC5pbmNsdWRlcygid2hlcmUiKSB8fCB0ZXh0LmluY2x1ZGVzKCJsb2NhdGlvbiIpKSByZXR1cm4gWyJXaGVyZSBzaG91bGQgd2UgbWVldD8iLCAiQW55IHBsYWNlIHlvdSBwcmVmZXI/IiwgIknigJltIG9wZW4iLCAiU291bmRzIGdvb2QiXTsgCiAgICAgICAgaWYgKHRleHQuaW5jbHVkZXMoImhhaGEiKSB8fCB0ZXh0LmluY2x1ZGVzKCJsb2wiKSkgcmV0dXJuIFsiSGFoYSDwn5iCIiwgIllvdeKAmXJlIGZ1bm55IiwgIvCfmIIiLCAiVGVsbCBtZSBtb3JlISJdOyAKICAgICAgICByZXR1cm4gWyJTb3VuZHMgZ3JlYXQhIiwgIlRlbGwgbWUgbW9yZSEiLCAiV2hhdCBhYm91dCB5b3U/IiwgIvCfmIoiXTsgCiAgICB9LCBbbWVzc2FnZXMsIHVzZXJJZF0pOwoKICAgIHVzZUVmZmVjdCgoKSA9PiB7CiAgICAgICAgaWYgKCFtYXRjaElkKSByZXR1cm47CiAgICAgICAgY29uc3Qga2V5ID0gYHNhZmV0eV9iYW5uZXJfZGlzbWlzc2VkXyR7bWF0Y2hJZH1gOwogICAgICAgIHNldFNhZmV0eURpc21pc3NlZChsb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpID09PSAiMSIpOwogICAgfSwgW21hdGNoSWRdKTsKCiAgICBjb25zdCBkaXNtaXNzU2FmZXR5ID0gKCkgPT4gewogICAgICAgIGlmICghbWF0Y2hJZCkgcmV0dXJuOwogICAgICAgIGNvbnN0IGtleSA9IGBzYWZldHlfYmFubmVyX2Rpc21pc3NlZF8ke21hdGNoSWR9YDsKICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShrZXksICIxIik7CiAgICAgICAgc2V0U2FmZXR5RGlzbWlzc2VkKHRydWUpOwogICAgfTsKCiAgICB1c2VFZmZlY3QoKCkgPT4gewogICAgICAgIGlmIChtZXNzYWdlcyAmJiBtZXNzYWdlcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIG1hcmtBc1JlYWQoeyBtYXRjaElkOiBtYXRjaElkIGFzIGFueSwgdXNlcklkIH0pOwogICAgICAgIH0KICAgIH0sIFttZXNzYWdlcywgbWFya0FzUmVhZCwgbWF0Y2hJZCwgdXNlcklkXSk7CgogICAgdXNlRWZmZWN0KCgpID0+IHsKICAgICAgICBpZiAoIW1hdGNoSWQgfHwgIXVzZXJJZCkgcmV0dXJuOwogICAgICAgIGNvbnN0IHQgPSB3aW5kb3cuc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgIHNldFR5cGluZ1N0YXR1cyh7IG1hdGNoSWQ6IG1hdGNoSWQgYXMgYW55LCB1c2VySWQsIGlzVHlwaW5nOiBtZXNzYWdlLnRyaW0oKS5sZW5ndGggPiAwIH0gYXMgYW55KS5jYXRjaCgoKSA9PiB7CiAgICAgICAgICAgICAgICAvLyBpZ25vcmUKICAgICAgICAgICAgfSk7CiAgICAgICAgfSwgMjUwKTsKICAgICAgICByZXR1cm4gKCkgPT4gd2luZG93LmNsZWFyVGltZW91dCh0KTsKICAgIH0sIFttZXNzYWdlLCBtYXRjaElkLCB1c2VySWQsIHNldFR5cGluZ1N0YXR1c10pOwoKICAgIHVzZUVmZmVjdCgoKSA9PiB7CiAgICAgICAgaWYgKCF1c2VySWQpIHJldHVybjsKCiAgICAgICAgdXBkYXRlTGFzdFNlZW4oeyB1c2VySWQgfSk7CiAgICAgICAgY29uc3QgaWQgPSB3aW5kb3cuc2V0SW50ZXJ2YWwoKCkgPT4gewogICAgICAgICAgICB1cGRhdGVMYXN0U2Vlbih7IHVzZXJJZCB9KTsKICAgICAgICB9LCAzMDAwMCk7CgogICAgICAgIHJldHVybiAoKSA9PiB3aW5kb3cuY2xlYXJJbnRlcnZhbChpZCk7CiAgICB9LCBbdXNlcklkLCB1cGRhdGVMYXN0U2Vlbl0pOwoKICAgIHVzZUVmZmVjdCgoKSA9PiB7CiAgICAgICAgbWVzc2FnZXNFbmRSZWYuY3VycmVudD8uc2Nyb2xsSW50b1ZpZXcoeyBiZWhhdmlvcjogInNtb290aCIgfSk7CiAgICB9LCBbbWVzc2FnZXNdKTsKCiAgICB1c2VFZmZlY3QoKCkgPT4gewogICAgICAgIGlmICghbWF0Y2hJZCB8fCAhdXNlcklkIHx8ICFlbnRpdGxlbWVudHM/LmlzUHJlbWl1bSkgcmV0dXJuOwogICAgICAgIGNvbnN0IGlkID0gd2luZG93LnNldEludGVydmFsKCgpID0+IHsKICAgICAgICAgICAgc2VuZER1ZVNjaGVkdWxlZE1lc3NhZ2VzKHsgdXNlcklkIH0gYXMgYW55KS5jYXRjaCgoKSA9PiB7CiAgICAgICAgICAgICAgICAvLyBpZ25vcmUKICAgICAgICAgICAgfSk7CiAgICAgICAgfSwgMTAwMDApOwogICAgICAgIHJldHVybiAoKSA9PiB3aW5kb3cuY2xlYXJJbnRlcnZhbChpZCk7CiAgICB9LCBbbWF0Y2hJZCwgdXNlcklkLCBlbnRpdGxlbWVudHM/LmlzUHJlbWl1bSwgc2VuZER1ZVNjaGVkdWxlZE1lc3NhZ2VzXSk7CgogICAgY29uc3QgZW1vamlHcm91cHMgPSBbCiAgICAgICAgeyBsYWJlbDogIlNtaWxleXMiLCBpdGVtczogWyLwn5iAIiwgIvCfmIMiLCAi8J+YhCIsICLwn5iBIiwgIvCfmIYiLCAi8J+YhSIsICLwn5iCIiwgIvCfpKMiLCAi8J+YiiIsICLwn5iNIiwgIvCfmJgiLCAi8J+lsCIsICLwn5iOIiwgIvCfpKkiLCAi8J+YhyIsICLwn6SXIiwgIvCfmIsiLCAi8J+YnCJdIH0sCiAgICAgICAgeyBsYWJlbDogIkdlc3R1cmVzIiwgaXRlbXM6IFsi8J+RjSIsICLwn5GOIiwgIvCfkY8iLCAi8J+ZjCIsICLwn6SdIiwgIvCfmY8iLCAi8J+RiyIsICLwn5GMIiwgIuKcjO+4jyIsICLwn6SeIiwgIvCfpJ8iLCAi8J+kmCIsICLwn5KqIiwgIvCfq7YiXSB9LAogICAgICAgIHsgbGFiZWw6ICJIZWFydHMiLCBpdGVtczogWyLinaTvuI8iLCAi8J+noSIsICLwn5KbIiwgIvCfkpoiLCAi8J+SmSIsICLwn5KcIiwgIvCfpI4iLCAi8J+WpCIsICLwn6SNIiwgIvCfkpYiLCAi8J+SlyIsICLwn5KTIiwgIvCfkp4iLCAi8J+SlSIsICLwn5KYIl0gfSwKICAgICAgICB7IGxhYmVsOiAiRmFjZXMiLCBpdGVtczogWyLwn5iuIiwgIvCfmLIiLCAi8J+YsyIsICLwn6W6IiwgIvCfmKIiLCAi8J+YrSIsICLwn5ihIiwgIvCfpKwiLCAi8J+YtCIsICLwn5isIiwgIvCfpJQiLCAi8J+ZgyIsICLwn6SQIiwgIvCfmLciXSB9LAogICAgICAgIHsgbGFiZWw6ICJGdW4iLCBpdGVtczogWyLwn46JIiwgIvCfjooiLCAi4pyoIiwgIvCflKUiLCAi8J+SryIsICLwn46IIiwgIvCfjoEiLCAi8J+NgCIsICLwn4yfIiwgIvCfko4iLCAi4pqhIiwgIvCfjIgiXSB9LAogICAgXTsKCiAgICBjb25zdCBpbnNlcnRFbW9qaSA9IChlbW9qaTogc3RyaW5nKSA9PiB7CiAgICAgICAgY29uc3QgdGFyZ2V0ID0gaW5wdXRSZWYuY3VycmVudDsKICAgICAgICBpZiAoIXRhcmdldCkgewogICAgICAgICAgICBzZXRNZXNzYWdlKChwcmV2KSA9PiBwcmV2ICsgZW1vamkpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBjb25zdCBzdGFydCA9IHRhcmdldC5zZWxlY3Rpb25TdGFydCA/PyBtZXNzYWdlLmxlbmd0aDsKICAgICAgICBjb25zdCBlbmQgPSB0YXJnZXQuc2VsZWN0aW9uRW5kID8/IG1lc3NhZ2UubGVuZ3RoOwogICAgICAgIGNvbnN0IG5leHQgPSBgJHttZXNzYWdlLnNsaWNlKDAsIHN0YXJ0KX0ke2Vtb2ppfSR7bWVzc2FnZS5zbGljZShlbmQpfWA7CiAgICAgICAgc2V0TWVzc2FnZShuZXh0KTsKCiAgICAgICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7CiAgICAgICAgICAgIHRhcmdldC5mb2N1cygpOwogICAgICAgICAgICBjb25zdCBjdXJzb3IgPSBzdGFydCArIGVtb2ppLmxlbmd0aDsKICAgICAgICAgICAgdGFyZ2V0LnNldFNlbGVjdGlvblJhbmdlKGN1cnNvciwgY3Vyc29yKTsKICAgICAgICB9KTsKICAgIH07CgogICAgY29uc3QgaGFuZGxlRW1vamlTZWxlY3QgPSAoZW1vamk6IHN0cmluZykgPT4gewogICAgICAgIGluc2VydEVtb2ppKGVtb2ppKTsKICAgICAgICBzZXRFbW9qaU9wZW4oZmFsc2UpOwogICAgfTsKCiAgICBjb25zdCBoYW5kbGVTZW5kID0gYXN5bmMgKCkgPT4gewogICAgICAgIGlmICghbWVzc2FnZS50cmltKCkgfHwgIXVzZXJJZCB8fCAhbWF0Y2hJZCkgcmV0dXJuOwoKICAgICAgICB0cnkgewogICAgICAgICAgICBhd2FpdCBzZW5kTWVzc2FnZSh7CiAgICAgICAgICAgICAgICBtYXRjaElkOiBtYXRjaElkIGFzIGFueSwKICAgICAgICAgICAgICAgIHNlbmRlcklkOiB1c2VySWQsCiAgICAgICAgICAgICAgICBib2R5OiBtZXNzYWdlLnRyaW0oKSwKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBzZXRNZXNzYWdlKCIiKTsKICAgICAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7CiAgICAgICAgICAgIHRvYXN0LmVycm9yKGVycm9yLm1lc3NhZ2UgfHwgIkZhaWxlZCB0byBzZW5kIG1lc3NhZ2UiKTsKICAgICAgICB9CiAgICB9OwoKICAgIGNvbnN0IE1BWF9BVFRBQ0hNRU5UX1NJWkUgPSA1MCAqIDEwMjQgKiAxMDI0OwoKICAgIGNvbnN0IHNlbmRQaG90byA9IGFzeW5jIChmaWxlOiBGaWxlKSA9PiB7CiAgICAgICAgaWYgKCF1c2VySWQgfHwgIW1hdGNoSWQpIHJldHVybjsKICAgICAgICAKICAgICAgICB0cnkgewogICAgICAgICAgICBjb25zdCBkYXRhVXJsID0gYXdhaXQgbmV3IFByb21pc2U8c3RyaW5nPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgICAgICAgICAgICAgICBjb25zdCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOwogICAgICAgICAgICAgICAgcmVhZGVyLm9uZXJyb3IgPSAoKSA9PiByZWplY3QobmV3IEVycm9yKCJGYWlsZWQgdG8gcmVhZCBmaWxlIikpOwogICAgICAgICAgICAgICAgcmVhZGVyLm9ubG9hZCA9ICgpID0+IHJlc29sdmUoU3RyaW5nKHJlYWRlci5yZXN1bHQgfHwgIiIpKTsKICAgICAgICAgICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGZpbGUpOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGF3YWl0IHNlbmRNZXNzYWdlKHsKICAgICAgICAgICAgICAgIG1hdGNoSWQ6IG1hdGNoSWQgYXMgYW55LAogICAgICAgICAgICAgICAgc2VuZGVySWQ6IHVzZXJJZCwKICAgICAgICAgICAgICAgIGJvZHk6ICJbUGhvdG9dIiwKICAgICAgICAgICAgICAgIHR5cGU6ICJwaG90byIsCiAgICAgICAgICAgICAgICBtZXRhZGF0YTogeyBwaG90b1VybDogZGF0YVVybCB9LAogICAgICAgICAgICB9IGFzIGFueSk7CiAgICAgICAgfSBjYXRjaCAoZXJyb3I6IGFueSkgewogICAgICAgICAgICB0b2FzdC5lcnJvcihlcnJvci5tZXNzYWdlIHx8ICJGYWlsZWQgdG8gc2VuZCBwaG90byIpOwogICAgICAgIH0KICAgIH07CgogICAgY29uc3QgdXBsb2FkQXR0YWNobWVudCA9IGFzeW5jIChmaWxlOiBGaWxlKSA9PiB7CiAgICAgICAgaWYgKCF1c2VySWQgfHwgIW1hdGNoSWQpIHJldHVybjsKICAgICAgICBpZiAoZmlsZS5zaXplID4gTUFYX0FUVEFDSE1FTlRfU0laRSkgewogICAgICAgICAgICB0b2FzdC5lcnJvcigiRmlsZSBleGNlZWRzIDUwTUIgbGltaXQiKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgcGVuZGluZ0lkID0gY3J5cHRvLnJhbmRvbVVVSUQoKTsKICAgICAgICBjb25zdCBwcmV2aWV3VXJsID0gZmlsZS50eXBlLnN0YXJ0c1dpdGgoImltYWdlLyIpIHx8IGZpbGUudHlwZS5zdGFydHNXaXRoKCJ2aWRlby8iKQogICAgICAgICAgICA/IFVSTC5jcmVhdGVPYmplY3RVUkwoZmlsZSkKICAgICAgICAgICAgOiB1bmRlZmluZWQ7CgogICAgICAgIHNldFBlbmRpbmdBdHRhY2htZW50cygocHJldikgPT4gWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBpZDogcGVuZGluZ0lkLAogICAgICAgICAgICAgICAgbmFtZTogZmlsZS5uYW1lLAogICAgICAgICAgICAgICAgdHlwZTogZmlsZS50eXBlIHx8ICJhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0iLAogICAgICAgICAgICAgICAgc2l6ZTogZmlsZS5zaXplLAogICAgICAgICAgICAgICAgcHJldmlld1VybCwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgLi4ucHJldiwKICAgICAgICBdKTsKCiAgICAgICAgc2V0VXBsb2FkaW5nQXR0YWNobWVudCh0cnVlKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBjb25zdCB1cGxvYWRVcmwgPSBhd2FpdCBnZW5lcmF0ZVVwbG9hZFVybCh7IHVzZXJJZCB9KTsKICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cGxvYWRVcmwsIHsKICAgICAgICAgICAgICAgIG1ldGhvZDogIlBPU1QiLAogICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgICJDb250ZW50LVR5cGUiOiBmaWxlLnR5cGUgfHwgImFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbSIsCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgYm9keTogZmlsZSwKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkZhaWxlZCB0byB1cGxvYWQgYXR0YWNobWVudCIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBjb25zdCB7IHN0b3JhZ2VJZCB9ID0gYXdhaXQgcmVzcG9uc2UuanNvbigpOwogICAgICAgICAgICBpZiAoIXN0b3JhZ2VJZCkgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJVcGxvYWQgZGlkIG5vdCByZXR1cm4gYSBzdG9yYWdlIGlkIik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGF3YWl0IHNlbmRNZXNzYWdlKHsKICAgICAgICAgICAgICAgIG1hdGNoSWQ6IG1hdGNoSWQgYXMgYW55LAogICAgICAgICAgICAgICAgc2VuZGVySWQ6IHVzZXJJZCwKICAgICAgICAgICAgICAgIGJvZHk6IGBTZW50IGEgZmlsZTogJHtmaWxlLm5hbWV9YCwKICAgICAgICAgICAgICAgIHR5cGU6ICJhdHRhY2htZW50IiwKICAgICAgICAgICAgICAgIG1ldGFkYXRhOiB7CiAgICAgICAgICAgICAgICAgICAgYXR0YWNobWVudElkOiBzdG9yYWdlSWQsCiAgICAgICAgICAgICAgICAgICAgYXR0YWNobWVudE5hbWU6IGZpbGUubmFtZSwKICAgICAgICAgICAgICAgICAgICBhdHRhY2htZW50VHlwZTogZmlsZS50eXBlIHx8ICJhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0iLAogICAgICAgICAgICAgICAgICAgIGF0dGFjaG1lbnRTaXplOiBmaWxlLnNpemUsCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICB9IGFzIGFueSk7CiAgICAgICAgfSBjYXRjaCAoZXJyb3I6IGFueSkgewogICAgICAgICAgICB0b2FzdC5lcnJvcihlcnJvcj8ubWVzc2FnZSB8fCAiRmFpbGVkIHRvIHVwbG9hZCBhdHRhY2htZW50Iik7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgc2V0UGVuZGluZ0F0dGFjaG1lbnRzKChwcmV2KSA9PiBwcmV2LmZpbHRlcigoaXRlbSkgPT4gaXRlbS5pZCAhPT0gcGVuZGluZ0lkKSk7CiAgICAgICAgICAgIGlmIChwcmV2aWV3VXJsKSB7CiAgICAgICAgICAgICAgICBVUkwucmV2b2tlT2JqZWN0VVJMKHByZXZpZXdVcmwpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHNldFVwbG9hZGluZ0F0dGFjaG1lbnQoZmFsc2UpOwogICAgICAgIH0KICAgIH07CgogICAgY29uc3QgaGFuZGxlRmlsZXMgPSAoZmlsZXM6IEZpbGVMaXN0IHwgbnVsbCkgPT4gewogICAgICAgIGlmICghZmlsZXMpIHJldHVybjsKICAgICAgICBBcnJheS5mcm9tKGZpbGVzKS5mb3JFYWNoKChmaWxlKSA9PiB1cGxvYWRBdHRhY2htZW50KGZpbGUpKTsKICAgIH07CgogICAgY29uc3Qgc2VuZEdpZiA9IGFzeW5jIChnaWZVcmw6IHN0cmluZykgPT4gewogICAgICAgIGlmICghdXNlcklkIHx8ICFtYXRjaElkKSByZXR1cm47CiAgICAgICAgCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgYXdhaXQgc2VuZE1lc3NhZ2UoewogICAgICAgICAgICAgICAgbWF0Y2hJZDogbWF0Y2hJZCBhcyBhbnksCiAgICAgICAgICAgICAgICBzZW5kZXJJZDogdXNlcklkLAogICAgICAgICAgICAgICAgYm9keTogIltHSUZdIiwKICAgICAgICAgICAgICAgIHR5cGU6ICJnaWYiLAogICAgICAgICAgICAgICAgbWV0YWRhdGE6IHsgZ2lmVXJsIH0sCiAgICAgICAgICAgIH0gYXMgYW55KTsKICAgICAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7CiAgICAgICAgICAgIHRvYXN0LmVycm9yKGVycm9yLm1lc3NhZ2UgfHwgIkZhaWxlZCB0byBzZW5kIEdJRiIpOwogICAgICAgIH0KICAgIH07CgogICAgY29uc3Qgc2VuZFZvaWNlID0gYXN5bmMgKHsgdm9pY2VVcmwsIGR1cmF0aW9uIH06IHsgdm9pY2VVcmw6IHN0cmluZzsgZHVyYXRpb246IG51bWJlciB9KSA9PiB7CiAgICAgICAgaWYgKCF1c2VySWQgfHwgIW1hdGNoSWQpIHJldHVybjsKICAgICAgICAKICAgICAgICB0cnkgewogICAgICAgICAgICBhd2FpdCBzZW5kTWVzc2FnZSh7CiAgICAgICAgICAgICAgICBtYXRjaElkOiBtYXRjaElkIGFzIGFueSwKICAgICAgICAgICAgICAgIHNlbmRlcklkOiB1c2VySWQsCiAgICAgICAgICAgICAgICBib2R5OiAiW1ZvaWNlIG1lc3NhZ2VdIiwKICAgICAgICAgICAgICAgIHR5cGU6ICJ2b2ljZSIsCiAgICAgICAgICAgICAgICBtZXRhZGF0YTogeyB2b2ljZVVybCwgdm9pY2VEdXJhdGlvbjogZHVyYXRpb24gfSwKICAgICAgICAgICAgfSBhcyBhbnkpOwogICAgICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHsKICAgICAgICAgICAgdG9hc3QuZXJyb3IoZXJyb3IubWVzc2FnZSB8fCAiRmFpbGVkIHRvIHNlbmQgdm9pY2UgbWVzc2FnZSIpOwogICAgICAgIH0KICAgIH07CgogICAgY29uc3QgaGFuZGxlRGVsZXRlQ2hhdCA9IGFzeW5jICgpID0+IHsKICAgICAgICBpZiAoIW1hdGNoSWQgfHwgIXVzZXJJZCkgcmV0dXJuOwoKICAgICAgICBpZiAoY29uZmlybSgiQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRlbGV0ZSB0aGlzIGNoYXQ/IikpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGF3YWl0IGRlbGV0ZUNoYXQoeyBtYXRjaElkOiBtYXRjaElkIGFzIGFueSwgdXNlcklkIH0pOwogICAgICAgICAgICAgICAgdG9hc3Quc3VjY2VzcygiQ2hhdCBkZWxldGVkIik7CiAgICAgICAgICAgICAgICBuYXZpZ2F0ZSgiL21lc3NhZ2VzIik7CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHsKICAgICAgICAgICAgICAgIHRvYXN0LmVycm9yKGVycm9yLm1lc3NhZ2UgfHwgIkZhaWxlZCB0byBkZWxldGUgY2hhdCIpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfTsKCiAgICBjb25zdCBoYW5kbGVEZWxldGVNZXNzYWdlID0gYXN5bmMgKG1lc3NhZ2VJZDogc3RyaW5nLCBkZWxldGVGb3JFdmVyeW9uZTogYm9vbGVhbikgPT4gewogICAgICAgIGlmICghdXNlcklkKSByZXR1cm47CgogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGF3YWl0IGRlbGV0ZU1lc3NhZ2UoeyBtZXNzYWdlSWQ6IG1lc3NhZ2VJZCBhcyBhbnksIHVzZXJJZCwgZGVsZXRlRm9yRXZlcnlvbmUgfSk7CiAgICAgICAgICAgIHRvYXN0LnN1Y2Nlc3MoZGVsZXRlRm9yRXZlcnlvbmUgPyAiTWVzc2FnZSBkZWxldGVkIGZvciBldmVyeW9uZSIgOiAiTWVzc2FnZSBkZWxldGVkIGxvY2FsbHkiKTsKICAgICAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7CiAgICAgICAgICAgIHRvYXN0LmVycm9yKGVycm9yLm1lc3NhZ2UgfHwgIkZhaWxlZCB0byBkZWxldGUgbWVzc2FnZSIpOwogICAgICAgIH0KICAgIH07CgogICAgY29uc3QgaGFuZGxlQmxvY2sgPSBhc3luYyAoKSA9PiB7CiAgICAgICAgaWYgKCFtYXRjaCB8fCAhdXNlcklkKSByZXR1cm47CgogICAgICAgIGlmIChjb25maXJtKGBBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gYmxvY2sgJHttYXRjaC5wcm9maWxlLm5hbWUgfHwgInRoaXMgdXNlciJ9P2ApKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBhd2FpdCBibG9ja1VzZXIoewogICAgICAgICAgICAgICAgICAgIGJsb2NrZXJJZDogdXNlcklkLAogICAgICAgICAgICAgICAgICAgIGJsb2NrZWRVc2VySWQ6IG1hdGNoLnVzZXJJZCwKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIHRvYXN0LnN1Y2Nlc3MoIlVzZXIgYmxvY2tlZCIpOwogICAgICAgICAgICAgICAgbmF2aWdhdGUoIi9tZXNzYWdlcyIpOwogICAgICAgICAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7CiAgICAgICAgICAgICAgICB0b2FzdC5lcnJvcihlcnJvci5tZXNzYWdlIHx8ICJGYWlsZWQgdG8gYmxvY2sgdXNlciIpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfTsKCiAgICAvLyBTaG93IGxvYWRpbmcgc3RhdGUgd2hpbGUgYXV0aGVudGljYXRpbmcgb3IgZmV0Y2hpbmcgZGF0YQogICAgaWYgKGF1dGhMb2FkaW5nIHx8ICF1c2VySWQpIHsKICAgICAgICByZXR1cm4gPENoYXRTa2VsZXRvbiAvPjsKICAgIH0KCiAgICBpZiAoIW1hdGNoIHx8ICFtZXNzYWdlcykgewogICAgICAgIHJldHVybiA8Q2hhdFNrZWxldG9uIC8+OwogICAgfQoKICAgIGNvbnN0IG90aGVyVXNlcklkID0gbWF0Y2gudXNlcklkOwoKICAgIGNvbnN0IHByaW1hcnlQaG90byA9IG1hdGNoLnByb2ZpbGUucGhvdG9zLmZpbmQoKHA6IGFueSkgPT4gcC5pc1ByaW1hcnkpIHx8IG1hdGNoLnByb2ZpbGUucGhvdG9zWzBdOwoKICAgIGNvbnN0IGxhc3RTZWVuQXQgPSAobWF0Y2ggYXMgYW55KS5sYXN0U2VlbkF0IGFzIG51bWJlciB8IG51bGwgfCB1bmRlZmluZWQ7CiAgICBjb25zdCBzaG93T25saW5lU3RhdHVzID0gKG1hdGNoIGFzIGFueSkuc2hvd09ubGluZVN0YXR1cyBhcyBib29sZWFuIHwgdW5kZWZpbmVkOwogICAgY29uc3QgaXNPbmxpbmUgPSB0eXBlb2YgbGFzdFNlZW5BdCA9PT0gIm51bWJlciIgPyBEYXRlLm5vdygpIC0gbGFzdFNlZW5BdCA8IDYwMDAwIDogZmFsc2U7CiAgICAKICAgIC8vIEZvcm1hdCBleGFjdCB0aW1lIGZvciBsYXN0IHNlZW4KICAgIGNvbnN0IGdldExhc3RTZWVuVGV4dCA9ICgpID0+IHsKICAgICAgICBpZiAoc2hvd09ubGluZVN0YXR1cyA9PT0gZmFsc2UpIHJldHVybiBudWxsOwogICAgICAgIGlmIChpc09ubGluZSkgcmV0dXJuICJPbmxpbmUiOwogICAgICAgIGlmICh0eXBlb2YgbGFzdFNlZW5BdCAhPT0gIm51bWJlciIpIHJldHVybiBudWxsOwogICAgICAgIAogICAgICAgIGNvbnN0IGxhc3RTZWVuRGF0ZSA9IG5ldyBEYXRlKGxhc3RTZWVuQXQpOwogICAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7CiAgICAgICAgY29uc3QgdG9kYXkgPSBuZXcgRGF0ZShub3cuZ2V0RnVsbFllYXIoKSwgbm93LmdldE1vbnRoKCksIG5vdy5nZXREYXRlKCkpOwogICAgICAgIGNvbnN0IHllc3RlcmRheSA9IG5ldyBEYXRlKHRvZGF5KTsKICAgICAgICB5ZXN0ZXJkYXkuc2V0RGF0ZSh5ZXN0ZXJkYXkuZ2V0RGF0ZSgpIC0gMSk7CiAgICAgICAgCiAgICAgICAgaWYgKGxhc3RTZWVuRGF0ZSA+PSB0b2RheSkgewogICAgICAgICAgICAvLyBUb2RheTogc2hvdyAiTGFzdCBzZWVuIGF0IEhIOk1NIEFNL1BNIgogICAgICAgICAgICByZXR1cm4gYExhc3Qgc2VlbiBhdCAke2Zvcm1hdChsYXN0U2VlbkRhdGUsICJoOm1tIGEiKX1gOwogICAgICAgIH0gZWxzZSBpZiAobGFzdFNlZW5EYXRlID49IHllc3RlcmRheSkgewogICAgICAgICAgICAvLyBZZXN0ZXJkYXk6IHNob3cgIkxhc3Qgc2VlbiB5ZXN0ZXJkYXkgYXQgSEg6TU0gQU0vUE0iCiAgICAgICAgICAgIHJldHVybiBgTGFzdCBzZWVuIHllc3RlcmRheSBhdCAke2Zvcm1hdChsYXN0U2VlbkRhdGUsICJoOm1tIGEiKX1gOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIE9sZGVyOiBzaG93ICJMYXN0IHNlZW4gb24gTU1NIEREIGF0IEhIOk1NIEFNL1BNIgogICAgICAgICAgICByZXR1cm4gYExhc3Qgc2VlbiBvbiAke2Zvcm1hdChsYXN0U2VlbkRhdGUsICJNTU0gZGQiKX0gYXQgJHtmb3JtYXQobGFzdFNlZW5EYXRlLCAiaDptbSBhIil9YDsKICAgICAgICB9CiAgICB9OwogICAgCiAgICBjb25zdCBsYXN0U2VlblRleHQgPSBnZXRMYXN0U2VlblRleHQoKTsKCgogICAgcmV0dXJuICgKICAgICAgICA8ZGl2CiAgICAgICAgICAgIGNsYXNzTmFtZT17YG1pbi1oLXNjcmVlbiBiZy1iYWNrZ3JvdW5kIGZsZXggZmxleC1jb2wgb3ZlcmZsb3ctaGlkZGVuICR7aXNEcmFnZ2luZyA/ICJyaW5nLTIgcmluZy1wcmltYXJ5LzYwIiA6ICIifWB9CiAgICAgICAgICAgIG9uRHJhZ092ZXI9eyhldmVudCkgPT4gewogICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgICAgIHNldElzRHJhZ2dpbmcodHJ1ZSk7CiAgICAgICAgICAgIH19CiAgICAgICAgICAgIG9uRHJhZ0xlYXZlPXsoZXZlbnQpID0+IHsKICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgICAgICBzZXRJc0RyYWdnaW5nKGZhbHNlKTsKICAgICAgICAgICAgfX0KICAgICAgICAgICAgb25Ecm9wPXsoZXZlbnQpID0+IHsKICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgICAgICBzZXRJc0RyYWdnaW5nKGZhbHNlKTsKICAgICAgICAgICAgICAgIGhhbmRsZUZpbGVzKGV2ZW50LmRhdGFUcmFuc2Zlci5maWxlcyk7CiAgICAgICAgICAgIH19CiAgICAgICAgPgogICAgICAgICAgICB7aXNEcmFnZ2luZyAmJiAoCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0iYWJzb2x1dGUgaW5zZXQtMCB6LTIwIGJnLWJhY2tncm91bmQvNzAgYmFja2Ryb3AtYmx1ci1zbSBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciI+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9ImZsZXggZmxleC1jb2wgaXRlbXMtY2VudGVyIGdhcC0yIHRleHQtY2VudGVyIj4KICAgICAgICAgICAgICAgICAgICAgICAgPFBhcGVyY2xpcCBjbGFzc05hbWU9InctMTAgaC0xMCB0ZXh0LXByaW1hcnkiIC8+CiAgICAgICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT0idGV4dC1sZyBmb250LXNlbWlib2xkIj5Ecm9wIGZpbGVzIHRvIHNlbmQ8L3A+CiAgICAgICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT0idGV4dC1zbSB0ZXh0LW11dGVkLWZvcmVncm91bmQiPlVwIHRvIDUwTUIgcGVyIGZpbGU8L3A+CiAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgKX0KICAgICAgICAgICAgey8qIEhlYWRlciAqL30KICAgICAgICAgICAgPGhlYWRlciBjbGFzc05hbWU9ImJnLWNhcmQgYm9yZGVyLWIgYm9yZGVyLWJvcmRlciBzdGlja3kgdG9wLTAgei0xMCI+CiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0iY29udGFpbmVyIG14LWF1dG8gcHgtMiBzbTpweC0zIG1kOnB4LTQgcHktMiBzbTpweS0zIj4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0iZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1iZXR3ZWVuIj4KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9ImZsZXggaXRlbXMtY2VudGVyIGdhcC0zIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxCdXR0b24gdmFyaWFudD0iZ2hvc3QiIHNpemU9Imljb24iIG9uQ2xpY2s9eygpID0+IG5hdmlnYXRlKCIvbWVzc2FnZXMiKX0+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEFycm93TGVmdCBjbGFzc05hbWU9InctNSBoLTUiIC8+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj4KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0iZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTMiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSJ3LTEwIGgtMTAgcm91bmRlZC1mdWxsIG92ZXJmbG93LWhpZGRlbiI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtwcmltYXJ5UGhvdG8gPyAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW1nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3JjPXtwcmltYXJ5UGhvdG8udXJsfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsdD17bWF0Y2gucHJvZmlsZS51c2VySWR9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPSJ3LWZ1bGwgaC1mdWxsIG9iamVjdC1jb3ZlciIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0idy1mdWxsIGgtZnVsbCBiZy1ncmFkaWVudC10by1iciBmcm9tLXByaW1hcnkvMjAgdG8tcHJpbWFyeS8xMCBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEhlYXJ0IGNsYXNzTmFtZT0idy01IGgtNSB0ZXh0LXByaW1hcnkvMzAiIC8+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGgyIGNsYXNzTmFtZT0iZm9udC1zZW1pYm9sZCI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7KG1hdGNoLnByb2ZpbGUubmFtZSB8fCAobWF0Y2ggYXMgYW55KS5uYW1lIHx8ICJVbmtub3duIil9LCB7bWF0Y2gucHJvZmlsZS5hZ2V9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvaDI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT0idGV4dC14cyB0ZXh0LW11dGVkLWZvcmVncm91bmQiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2xhc3RTZWVuVGV4dCB8fCBtYXRjaC5wcm9maWxlLmxvY2F0aW9ufQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3A+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CgogICAgICAgICAgICAgICAgICAgICAgICA8RHJvcGRvd25NZW51PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPERyb3Bkb3duTWVudVRyaWdnZXIgYXNDaGlsZD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QnV0dG9uIHZhcmlhbnQ9Imdob3N0IiBzaXplPSJpY29uIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPE1vcmVWZXJ0aWNhbCBjbGFzc05hbWU9InctNSBoLTUiIC8+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0Ryb3Bkb3duTWVudVRyaWdnZXI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8RHJvcGRvd25NZW51Q29udGVudCBhbGlnbj0iZW5kIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8RHJvcGRvd25NZW51SXRlbSBvbkNsaWNrPXsoKSA9PiBzZXRSZXBvcnRPcGVuKHRydWUpfT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVwb3J0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9Ecm9wZG93bk1lbnVJdGVtPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxEcm9wZG93bk1lbnVJdGVtIG9uQ2xpY2s9eygpID0+IG5hdmlnYXRlKGAvcHJvZmlsZS8ke21hdGNoLnVzZXJJZH1gKX0+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZpZXcgUHJvZmlsZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvRHJvcGRvd25NZW51SXRlbT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8RHJvcGRvd25NZW51SXRlbSBvbkNsaWNrPXtoYW5kbGVEZWxldGVDaGF0fT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRGVsZXRlIENoYXQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0Ryb3Bkb3duTWVudUl0ZW0+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPERyb3Bkb3duTWVudUl0ZW0gb25DbGljaz17aGFuZGxlQmxvY2t9IGNsYXNzTmFtZT0idGV4dC1yZWQtNjAwIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQmxvY2sgVXNlcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvRHJvcGRvd25NZW51SXRlbT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvRHJvcGRvd25NZW51Q29udGVudD4KICAgICAgICAgICAgICAgICAgICAgICAgPC9Ecm9wZG93bk1lbnU+CiAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPC9oZWFkZXI+CgoKICAgICAgICAgICAgey8qIE1lc3NhZ2VzICovfQogICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0iZmxleC0xIG92ZXJmbG93LXktYXV0byI+CiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0iY29udGFpbmVyIG14LWF1dG8gcHgtMiBzbTpweC0zIG1kOnB4LTQgcHktMyBzbTpweS00IG1kOnB5LTYgbWF4LXctMnhsIHNwYWNlLXktMyBzbTpzcGFjZS15LTQiPgogICAgICAgICAgICAgICAgICAgIHt1bmlxdWVNZXNzYWdlcy5sZW5ndGggPT09IDAgPyAoCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSJ0ZXh0LWNlbnRlciBweS0xMiI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8SGVhcnQgY2xhc3NOYW1lPSJ3LTE2IGgtMTYgbXgtYXV0byB0ZXh0LXByaW1hcnkgbWItNCIgLz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxoMyBjbGFzc05hbWU9InRleHQtbGcgZm9udC1zZW1pYm9sZCBtYi0yIj5Zb3UgbWF0Y2hlZCE8L2gzPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPSJ0ZXh0LW11dGVkLWZvcmVncm91bmQiPlNlbmQgYSBtZXNzYWdlIHRvIHN0YXJ0IHRoZSBjb252ZXJzYXRpb248L3A+CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgeyFzYWZldHlEaXNtaXNzZWQgJiYgbWF0Y2hJZCAmJiAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9Im10LTYiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8U2FmZXR5QmFubmVyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkRpc21pc3M9e2Rpc21pc3NTYWZldHl9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkxlYXJuTW9yZT17KCkgPT4gbmF2aWdhdGUoIi9zYWZldHkiKX0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uUmVwb3J0PXsoKSA9PiBzZXRSZXBvcnRPcGVuKHRydWUpfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgKX0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7bWF0Y2hJZCAmJiBvdGhlclVzZXJJZCAmJiAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9Im10LTYgdGV4dC1sZWZ0Ij4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEljZWJyZWFrZXJTdWdnZXN0aW9ucwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2hJZD17bWF0Y2hJZCBhcyBhbnl9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdGhlclVzZXJJZD17b3RoZXJVc2VySWQgYXMgYW55fQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlld2VySWQ9e3VzZXJJZH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uU2VsZWN0PXsobSkgPT4gc2V0TWVzc2FnZShtKX0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9CiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgICkgOiAoCiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VzLm1hcCgobXNnOiBhbnkpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzTWluZSA9IG1zZy5zZW5kZXJJZCA9PT0gdXNlcklkOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbWVzc2FnZVJlYWN0aW9ucyA9IHJlYWN0aW9uc0J5TWVzc2FnZT8uW21zZy5faWRdIHx8IFtdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBXaGF0c0FwcC1zdHlsZSB0aWNrIGxvZ2ljCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdGlja1N0YXR1cyA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNNaW5lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVjZWlwdCA9IChyZWFkUmVjZWlwdHMgYXMgYW55KT8uW21zZy5faWRdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlY2VpdmVySXNPbmxpbmUgPSByZWNlaXZlclByZXNlbmNlPy5zdGF0dXMgPT09ICJvbmxpbmUiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtc2cuaXNSZWFkIHx8IHJlY2VpcHQ/LnJlYWRBdCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aWNrU3RhdHVzID0gInJlYWQiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobXNnLmRlbGl2ZXJlZEF0ICYmIHJlY2VpdmVySXNPbmxpbmUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGlja1N0YXR1cyA9ICJkZWxpdmVyZWQiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobXNnLmRlbGl2ZXJlZEF0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpY2tTdGF0dXMgPSAic2VudCI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGlja1N0YXR1cyA9ICJwZW5kaW5nIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleT17bXNnLl9pZH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtgZmxleCAke2lzTWluZSA/ICJqdXN0aWZ5LWVuZCIgOiAianVzdGlmeS1zdGFydCJ9YH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtgbWF4LXctWzcwJV0gJHtpc01pbmUgPyAib3JkZXItMiIgOiAib3JkZXItMSJ9YH0+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17YGZsZXggaXRlbXMtc3RhcnQgZ2FwLTIgJHtpc01pbmUgPyAianVzdGlmeS1lbmQiIDogImp1c3RpZnktc3RhcnQifWB9PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHshaXNNaW5lICYmICgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPERyb3Bkb3duTWVudT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxEcm9wZG93bk1lbnVUcmlnZ2VyIGFzQ2hpbGQ+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEJ1dHRvbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXJpYW50PSJnaG9zdCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZT0iaWNvbiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPSJoLTYgdy02IHRleHQtbXV0ZWQtZm9yZWdyb3VuZCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxNb3JlVmVydGljYWwgY2xhc3NOYW1lPSJ3LTMgaC0zIiAvPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9Ecm9wZG93bk1lbnVUcmlnZ2VyPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPERyb3Bkb3duTWVudUNvbnRlbnQgYWxpZ249InN0YXJ0Ij4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8RHJvcGRvd25NZW51SXRlbQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBoYW5kbGVEZWxldGVNZXNzYWdlKG1zZy5faWQsIGZhbHNlKX0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFzaDIgY2xhc3NOYW1lPSJ3LTMgaC0zIG1yLTIiIC8+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlbGV0ZSBmb3IgbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0Ryb3Bkb3duTWVudUl0ZW0+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L0Ryb3Bkb3duTWVudUNvbnRlbnQ+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvRHJvcGRvd25NZW51PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2ByZWxhdGl2ZSBweC00IHB5LTIuNSBtYXgtdy1mdWxsIGJyZWFrLXdvcmRzICR7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc01pbmUgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyAiYmctZ3JhZGllbnQtdG8tYnIgZnJvbS1wcmltYXJ5IHRvLXByaW1hcnkvOTAgdGV4dC1wcmltYXJ5LWZvcmVncm91bmQgcm91bmRlZC1bMjBweF0gcm91bmRlZC1ici1zbSBzaGFkb3ctbGcgc2hhZG93LXByaW1hcnkvMjAiIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogImJnLWNhcmQgdGV4dC1jYXJkLWZvcmVncm91bmQgYm9yZGVyIGJvcmRlci1ib3JkZXIvNTAgcm91bmRlZC1bMjBweF0gcm91bmRlZC1ibC1zbSBzaGFkb3ctbWQiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gYmFja2Ryb3AtYmx1ci1zbSB0cmFuc2l0aW9uLWFsbCBkdXJhdGlvbi0yMDAgaG92ZXI6c2hhZG93LXhsYH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHttc2cuaXNEZWxldGVkID8gKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPSJ0ZXh0LXNtIGl0YWxpYyBvcGFjaXR5LTcwIj5UaGlzIG1lc3NhZ2Ugd2FzIGRlbGV0ZWQ8L3A+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiBtc2cudHlwZSA9PT0gImdpZiIgJiYgbXNnLm1ldGFkYXRhPy5naWZVcmwgPyAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0ic3BhY2UteS0yIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW1nIHNyYz17bXNnLm1ldGFkYXRhLmdpZlVybH0gYWx0PSJnaWYiIGNsYXNzTmFtZT0icm91bmRlZC1tZCBtYXgtaC02NCB3LWZ1bGwgb2JqZWN0LWNvdmVyIiAvPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiBtc2cudHlwZSA9PT0gInBob3RvIiAmJiBtc2cubWV0YWRhdGE/LnBob3RvVXJsID8gKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9InNwYWNlLXktMiI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGltZyBzcmM9e21zZy5tZXRhZGF0YS5waG90b1VybH0gYWx0PSJwaG90byIgY2xhc3NOYW1lPSJyb3VuZGVkLW1kIG1heC1oLTgwIHctZnVsbCBvYmplY3QtY292ZXIiIC8+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSA6IG1zZy50eXBlID09PSAidm9pY2UiICYmIG1zZy5tZXRhZGF0YT8udm9pY2VVcmwgPyAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YXVkaW8gY29udHJvbHMgc3JjPXttc2cubWV0YWRhdGEudm9pY2VVcmx9IGNsYXNzTmFtZT0idy1mdWxsIiAvPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApIDogbXNnLnR5cGUgPT09ICJhdHRhY2htZW50IiAmJiBtc2cubWV0YWRhdGE/LmF0dGFjaG1lbnRJZCA/ICgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSJzcGFjZS15LTIiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHttc2cubWV0YWRhdGE/LmF0dGFjaG1lbnRUeXBlPy5zdGFydHNXaXRoKCJpbWFnZS8iKSAmJiBtc2cubWV0YWRhdGE/LmF0dGFjaG1lbnRVcmwgPyAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbWcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNyYz17bXNnLm1ldGFkYXRhLmF0dGFjaG1lbnRVcmx9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbHQ9e21zZy5tZXRhZGF0YS5hdHRhY2htZW50TmFtZSB8fCAiQXR0YWNobWVudCJ9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9InJvdW5kZWQtbWQgbWF4LWgtODAgdy1mdWxsIG9iamVjdC1jb3ZlciIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApIDogbXNnLm1ldGFkYXRhPy5hdHRhY2htZW50VHlwZT8uc3RhcnRzV2l0aCgidmlkZW8vIikgJiYgbXNnLm1ldGFkYXRhPy5hdHRhY2htZW50VXJsID8gKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dmlkZW8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNyYz17bXNnLm1ldGFkYXRhLmF0dGFjaG1lbnRVcmx9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cm9scwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPSJyb3VuZGVkLW1kIG1heC1oLTgwIHctZnVsbCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApIDogKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0iZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTIiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFBhcGVyY2xpcCBjbGFzc05hbWU9InctNCBoLTQiIC8+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9InRleHQtc20gZm9udC1tZWRpdW0iPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHttc2cubWV0YWRhdGE/LmF0dGFjaG1lbnROYW1lIHx8ICJBdHRhY2htZW50In0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc3Bhbj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7bXNnLm1ldGFkYXRhPy5hdHRhY2htZW50VXJsICYmICgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhyZWY9e21zZy5tZXRhZGF0YS5hdHRhY2htZW50VXJsfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0PSJfYmxhbmsiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWw9Im5vcmVmZXJyZXIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9ImlubGluZS1mbGV4IGl0ZW1zLWNlbnRlciBnYXAtMSB0ZXh0LXhzIGZvbnQtc2VtaWJvbGQgdW5kZXJsaW5lIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8RG93bmxvYWQgY2xhc3NOYW1lPSJ3LTMgaC0zIiAvPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRG93bmxvYWQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9hPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSA6ICgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT0idGV4dC1zbSI+e21zZy5ib2R5fTwvcD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHshbXNnLmlzRGVsZXRlZCAmJiAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8TWVzc2FnZVJlYWN0aW9ucwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VJZD17bXNnLl9pZH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQ9e3VzZXJJZCBhcyBhbnl9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhY3Rpb25zPXttZXNzYWdlUmVhY3Rpb25zfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3dQaWNrZXI9e2ZhbHNlfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7aXNNaW5lICYmICgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPERyb3Bkb3duTWVudT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxEcm9wZG93bk1lbnVUcmlnZ2VyIGFzQ2hpbGQ+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEJ1dHRvbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXJpYW50PSJnaG9zdCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZT0iaWNvbiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPSJoLTYgdy02IHRleHQtbXV0ZWQtZm9yZWdyb3VuZCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxNb3JlVmVydGljYWwgY2xhc3NOYW1lPSJ3LTMgaC0zIiAvPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9Ecm9wZG93bk1lbnVUcmlnZ2VyPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPERyb3Bkb3duTWVudUNvbnRlbnQgYWxpZ249ImVuZCI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPERyb3Bkb3duTWVudUl0ZW0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gaGFuZGxlRGVsZXRlTWVzc2FnZShtc2cuX2lkLCBmYWxzZSl9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhc2gyIGNsYXNzTmFtZT0idy0zIGgtMyBtci0yIiAvPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEZWxldGUgZm9yIG1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9Ecm9wZG93bk1lbnVJdGVtPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxEcm9wZG93bk1lbnVJdGVtCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IGhhbmRsZURlbGV0ZU1lc3NhZ2UobXNnLl9pZCwgdHJ1ZSl9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT0idGV4dC1yZWQtNjAwIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYXNoMiBjbGFzc05hbWU9InctMyBoLTMgbXItMiIgLz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRGVsZXRlIGZvciBldmVyeW9uZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvRHJvcGRvd25NZW51SXRlbT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvRHJvcGRvd25NZW51Q29udGVudD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9Ecm9wZG93bk1lbnU+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2BtdC0xIGZsZXggaXRlbXMtY2VudGVyIGdhcC0yIHRleHQteHMgdGV4dC1tdXRlZC1mb3JlZ3JvdW5kICR7aXNNaW5lID8gImp1c3RpZnktZW5kIiA6ICJqdXN0aWZ5LXN0YXJ0In1gfT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj57Zm9ybWF0KG5ldyBEYXRlKG1zZy5jcmVhdGVkQXQpLCAiUFAgcCIpfTwvc3Bhbj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7aXNNaW5lICYmICgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPSJpbmxpbmUtZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTEiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3RpY2tTdGF0dXMgPT09ICJyZWFkIiA/ICgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Q2hlY2tDaGVjayBjbGFzc05hbWU9InctMyBoLTMgdGV4dC1ibHVlLTUwMCIgLz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiB0aWNrU3RhdHVzID09PSAiZGVsaXZlcmVkIiA/ICgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Q2hlY2tDaGVjayBjbGFzc05hbWU9InctMyBoLTMgdGV4dC1tdXRlZC1mb3JlZ3JvdW5kIiAvPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSA6IHRpY2tTdGF0dXMgPT09ICJzZW50IiA/ICgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Q2hlY2sgY2xhc3NOYW1lPSJ3LTMgaC0zIHRleHQtbXV0ZWQtZm9yZWdyb3VuZCIgLz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgOiAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPENsb2NrIGNsYXNzTmFtZT0idy0zIGgtMyB0ZXh0LW11dGVkLWZvcmVncm91bmQiIC8+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKX0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgICl9CiAgICAgICAgICAgICAgICAgICAgPGRpdiByZWY9e21lc3NhZ2VzRW5kUmVmfSAvPgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDwvZGl2PgoKICAgICAgICAgICAgey8qIElucHV0ICovfQogICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0iYmctY2FyZCBib3JkZXItdCBib3JkZXItYm9yZGVyIHN0aWNreSBib3R0b20tMCI+CiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0iY29udGFpbmVyIG14LWF1dG8gcHgtMiBzbTpweC0zIG1kOnB4LTQgcHktMiBzbTpweS0zIG1kOnB5LTQgbWF4LXctMnhsIj4KICAgICAgICAgICAgICAgICAgICB7bWF0Y2hJZCAmJiB1c2VySWQgJiYgKAogICAgICAgICAgICAgICAgICAgICAgICA8VHlwaW5nSW5kaWNhdG9yCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXRjaElkPXttYXRjaElkIGFzIGFueX0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZD17dXNlcklkIGFzIGFueX0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG90aGVyTmFtZT17bWF0Y2gucHJvZmlsZS5uYW1lIHx8IChtYXRjaCBhcyBhbnkpLm5hbWV9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdGhlclBob3RvVXJsPXtwcmltYXJ5UGhvdG8/LnVybH0KICAgICAgICAgICAgICAgICAgICAgICAgLz4KICAgICAgICAgICAgICAgICAgICApfQoKICAgICAgICAgICAgICAgICAgICB7c21hcnRSZXBsaWVzLmxlbmd0aCA+IDAgJiYgKAogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0ibWItMyBmbGV4IGZsZXgtd3JhcCBnYXAtMiI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7c21hcnRSZXBsaWVzLm1hcCgocikgPT4gKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxCdXR0b24ga2V5PXtyfSB0eXBlPSJidXR0b24iIHZhcmlhbnQ9Im91dGxpbmUiIHNpemU9InNtIiBvbkNsaWNrPXsoKSA9PiBzZXRNZXNzYWdlKHIpfT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3J9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICApKX0KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgKX0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0iZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTIiPgogICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZj17cGhvdG9JbnB1dFJlZn0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9ImZpbGUiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NlcHQ9ImltYWdlLyoiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9ImhpZGRlbiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXsoZSkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGYgPSBlLnRhcmdldC5maWxlcz8uWzBdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmKSBzZW5kUGhvdG8oZik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5jdXJyZW50VGFyZ2V0LnZhbHVlID0gIiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fQogICAgICAgICAgICAgICAgICAgICAgICAvPgogICAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZj17ZmlsZUlucHV0UmVmfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT0iZmlsZSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT0iaGlkZGVuIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9eyhlKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZiA9IGUudGFyZ2V0LmZpbGVzPy5bMF07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGYpIHVwbG9hZEF0dGFjaG1lbnQoZik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5jdXJyZW50VGFyZ2V0LnZhbHVlID0gIiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fQogICAgICAgICAgICAgICAgICAgICAgICAvPgoKICAgICAgICAgICAgICAgICAgICAgICAgPEJ1dHRvbiB0eXBlPSJidXR0b24iIHZhcmlhbnQ9Im91dGxpbmUiIHNpemU9Imljb24iIG9uQ2xpY2s9eygpID0+IHNldEdpZk9wZW4odHJ1ZSl9IHRpdGxlPSJTZW5kIEdJRiI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8SW1hZ2VJY29uIGNsYXNzTmFtZT0idy01IGgtNSIgLz4KICAgICAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+CgogICAgICAgICAgICAgICAgICAgICAgICA8QnV0dG9uCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPSJidXR0b24iCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXJpYW50PSJvdXRsaW5lIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gcGhvdG9JbnB1dFJlZi5jdXJyZW50Py5jbGljaygpfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9IlNlbmQgcGhvdG8iCiAgICAgICAgICAgICAgICAgICAgICAgID4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBob3RvCiAgICAgICAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPgogICAgICAgICAgICAgICAgICAgICAgICA8QnV0dG9uCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPSJidXR0b24iCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXJpYW50PSJvdXRsaW5lIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZT0iaWNvbiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IGZpbGVJbnB1dFJlZi5jdXJyZW50Py5jbGljaygpfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9e3VwbG9hZGluZ0F0dGFjaG1lbnR9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT0iQXR0YWNoIGZpbGUiCiAgICAgICAgICAgICAgICAgICAgICAgID4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxQYXBlcmNsaXAgY2xhc3NOYW1lPSJ3LTUgaC01IiAvPgogICAgICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj4KCiAgICAgICAgICAgICAgICAgICAgICAgIHtlbnRpdGxlbWVudHM/LmlzUHJlbWl1bSAmJiAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QnV0dG9uCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT0iYnV0dG9uIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnQ9Im91dGxpbmUiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZT0iaWNvbiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBzZXRTY2hlZHVsZU9wZW4odHJ1ZSl9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9eyFtZXNzYWdlLnRyaW0oKX0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT0iU2NoZWR1bGUgbWVzc2FnZSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgID4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Q2xvY2sgY2xhc3NOYW1lPSJ3LTUgaC01IiAvPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+CiAgICAgICAgICAgICAgICAgICAgICAgICl9CgogICAgICAgICAgICAgICAgICAgICAgICA8Vm9pY2VNZXNzYWdlIG9uU2VuZD17c2VuZFZvaWNlfSBkaXNhYmxlZD17IWVudGl0bGVtZW50c30gLz4KCiAgICAgICAgICAgICAgICAgICAgICAgIDxQb3BvdmVyIG9wZW49e2Vtb2ppT3Blbn0gb25PcGVuQ2hhbmdlPXtzZXRFbW9qaU9wZW59PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPFBvcG92ZXJUcmlnZ2VyIGFzQ2hpbGQ+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEJ1dHRvbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPSJidXR0b24iCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnQ9Im91dGxpbmUiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU9Imljb24iCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPSJBZGQgZW1vamkiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8U21pbGUgY2xhc3NOYW1lPSJ3LTUgaC01IiAvPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9Qb3BvdmVyVHJpZ2dlcj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxQb3BvdmVyQ29udGVudCBjbGFzc05hbWU9InAtMyB3LTcyIiBhbGlnbj0ic3RhcnQiIHNpZGU9InRvcCI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9InNwYWNlLXktMyI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtlbW9qaUdyb3Vwcy5tYXAoKGdyb3VwKSA9PiAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGtleT17Z3JvdXAubGFiZWx9IGNsYXNzTmFtZT0ic3BhY2UteS0yIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9InRleHQteHMgZm9udC1zZW1pYm9sZCB0ZXh0LW11dGVkLWZvcmVncm91bmQiPntncm91cC5sYWJlbH08L3A+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9ImdyaWQgZ3JpZC1jb2xzLTggZ2FwLTEiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Z3JvdXAuaXRlbXMubWFwKChlbW9qaSkgPT4gKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleT17YCR7Z3JvdXAubGFiZWx9LSR7ZW1vaml9YH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPSJidXR0b24iCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPSJ0ZXh0LWxnIGhvdmVyOnNjYWxlLTExMCB0cmFuc2l0aW9uLXRyYW5zZm9ybSByb3VuZGVkIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IGhhbmRsZUVtb2ppU2VsZWN0KGVtb2ppKX0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ZW1vaml9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSl9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKSl9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L1BvcG92ZXJDb250ZW50PgogICAgICAgICAgICAgICAgICAgICAgICA8L1BvcG92ZXI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxUZXh0YXJlYQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmPXtpbnB1dFJlZn0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXttZXNzYWdlfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9eyhlKSA9PiBzZXRNZXNzYWdlKGUudGFyZ2V0LnZhbHVlKX0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uS2V5RG93bj17KGUpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZS5rZXkgPT09ICJFbnRlciIgJiYgIWUuc2hpZnRLZXkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVTZW5kKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfX0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPSJUeXBlIGEgbWVzc2FnZS4uLiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT0iZmxleC0xIG1pbi1oLVs0NHB4XSByZXNpemUtbm9uZSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvd3M9ezF9CiAgICAgICAgICAgICAgICAgICAgICAgIC8+CiAgICAgICAgICAgICAgICAgICAgICAgIDxCdXR0b24gb25DbGljaz17aGFuZGxlU2VuZH0gc2l6ZT0iaWNvbiIgZGlzYWJsZWQ9eyFtZXNzYWdlLnRyaW0oKX0+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8U2VuZCBjbGFzc05hbWU9InctNSBoLTUiIC8+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPgogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDwvZGl2PgoKICAgICAgICAgICAgPFJlcG9ydE1vZGFsCiAgICAgICAgICAgICAgICBpc09wZW49e3JlcG9ydE9wZW59CiAgICAgICAgICAgICAgICBvbkNsb3NlPXsoKSA9PiBzZXRSZXBvcnRPcGVuKGZhbHNlKX0KICAgICAgICAgICAgICAgIHJlcG9ydGVySWQ9e3VzZXJJZH0KICAgICAgICAgICAgICAgIHJlcG9ydGVkVXNlcklkPXtvdGhlclVzZXJJZH0KICAgICAgICAgICAgLz4KCiAgICAgICAgICAgIDxHaWZQaWNrZXIgaXNPcGVuPXtnaWZPcGVufSBvbkNsb3NlPXsoKSA9PiBzZXRHaWZPcGVuKGZhbHNlKX0gb25QaWNrPXtzZW5kR2lmfSAvPgoKICAgICAgICAgICAge21hdGNoSWQgJiYgdXNlcklkICYmIGVudGl0bGVtZW50cz8uaXNQcmVtaXVtICYmICgKICAgICAgICAgICAgICAgIDxTY2hlZHVsZU1lc3NhZ2UKICAgICAgICAgICAgICAgICAgICBpc09wZW49e3NjaGVkdWxlT3Blbn0KICAgICAgICAgICAgICAgICAgICBvbkNsb3NlPXsoKSA9PiBzZXRTY2hlZHVsZU9wZW4oZmFsc2UpfQogICAgICAgICAgICAgICAgICAgIG1hdGNoSWQ9e21hdGNoSWQgYXMgYW55fQogICAgICAgICAgICAgICAgICAgIHVzZXJJZD17dXNlcklkIGFzIGFueX0KICAgICAgICAgICAgICAgICAgICBpbml0aWFsQm9keT17bWVzc2FnZX0KICAgICAgICAgICAgICAgIC8+CiAgICAgICAgICAgICl9CiAgICAgICAgPC9kaXY+CiAgICApOwp9OwoKZXhwb3J0IGRlZmF1bHQgQ2hhdDsK"}