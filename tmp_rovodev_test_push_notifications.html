{"data":"PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KPGhlYWQ+CiAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+CiAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCI+CiAgICA8dGl0bGU+UHVzaCBOb3RpZmljYXRpb24gVGVzdCAtIFB1cmVNYXRjaDI1NDwvdGl0bGU+CiAgICA8c3R5bGU+CiAgICAgICAgYm9keSB7CiAgICAgICAgICAgIGZvbnQtZmFtaWx5OiAtYXBwbGUtc3lzdGVtLCBCbGlua01hY1N5c3RlbUZvbnQsICdTZWdvZSBVSScsIFJvYm90bywgc2Fucy1zZXJpZjsKICAgICAgICAgICAgbWF4LXdpZHRoOiA4MDBweDsKICAgICAgICAgICAgbWFyZ2luOiA1MHB4IGF1dG87CiAgICAgICAgICAgIHBhZGRpbmc6IDIwcHg7CiAgICAgICAgICAgIGJhY2tncm91bmQ6ICNmNWY1ZjU7CiAgICAgICAgfQogICAgICAgIC5jYXJkIHsKICAgICAgICAgICAgYmFja2dyb3VuZDogd2hpdGU7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDEycHg7CiAgICAgICAgICAgIHBhZGRpbmc6IDI0cHg7CiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDIwcHg7CiAgICAgICAgICAgIGJveC1zaGFkb3c6IDAgMnB4IDhweCByZ2JhKDAsMCwwLDAuMSk7CiAgICAgICAgfQogICAgICAgIGgxIHsgY29sb3I6ICMzMzM7IG1hcmdpbi10b3A6IDA7IH0KICAgICAgICBoMiB7IGNvbG9yOiAjNjY2OyBmb250LXNpemU6IDE4cHg7IGJvcmRlci1ib3R0b206IDJweCBzb2xpZCAjZTkxZTYzOyBwYWRkaW5nLWJvdHRvbTogOHB4OyB9CiAgICAgICAgYnV0dG9uIHsKICAgICAgICAgICAgYmFja2dyb3VuZDogI2U5MWU2MzsKICAgICAgICAgICAgY29sb3I6IHdoaXRlOwogICAgICAgICAgICBib3JkZXI6IG5vbmU7CiAgICAgICAgICAgIHBhZGRpbmc6IDEycHggMjRweDsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogOHB4OwogICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTRweDsKICAgICAgICAgICAgbWFyZ2luOiA4cHggOHB4IDhweCAwOwogICAgICAgICAgICBmb250LXdlaWdodDogNTAwOwogICAgICAgIH0KICAgICAgICBidXR0b246aG92ZXIgeyBiYWNrZ3JvdW5kOiAjYzIxODViOyB9CiAgICAgICAgYnV0dG9uOmRpc2FibGVkIHsKICAgICAgICAgICAgYmFja2dyb3VuZDogI2NjYzsKICAgICAgICAgICAgY3Vyc29yOiBub3QtYWxsb3dlZDsKICAgICAgICB9CiAgICAgICAgLnN0YXR1cyB7CiAgICAgICAgICAgIHBhZGRpbmc6IDEycHg7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDhweDsKICAgICAgICAgICAgbWFyZ2luOiAxMnB4IDA7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTRweDsKICAgICAgICB9CiAgICAgICAgLnN0YXR1cy5zdWNjZXNzIHsgYmFja2dyb3VuZDogI2Q0ZWRkYTsgY29sb3I6ICMxNTU3MjQ7IH0KICAgICAgICAuc3RhdHVzLmVycm9yIHsgYmFja2dyb3VuZDogI2Y4ZDdkYTsgY29sb3I6ICM3MjFjMjQ7IH0KICAgICAgICAuc3RhdHVzLmluZm8geyBiYWNrZ3JvdW5kOiAjZDFlY2YxOyBjb2xvcjogIzBjNTQ2MDsgfQogICAgICAgIC5zdGF0dXMud2FybmluZyB7IGJhY2tncm91bmQ6ICNmZmYzY2Q7IGNvbG9yOiAjODU2NDA0OyB9CiAgICAgICAgcHJlIHsKICAgICAgICAgICAgYmFja2dyb3VuZDogI2Y4ZjlmYTsKICAgICAgICAgICAgcGFkZGluZzogMTJweDsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNnB4OwogICAgICAgICAgICBvdmVyZmxvdy14OiBhdXRvOwogICAgICAgICAgICBmb250LXNpemU6IDEycHg7CiAgICAgICAgfQogICAgICAgIC5ncmlkIHsKICAgICAgICAgICAgZGlzcGxheTogZ3JpZDsKICAgICAgICAgICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiByZXBlYXQoYXV0by1maXQsIG1pbm1heCgyMDBweCwgMWZyKSk7CiAgICAgICAgICAgIGdhcDogMTJweDsKICAgICAgICAgICAgbWFyZ2luOiAxNnB4IDA7CiAgICAgICAgfQogICAgPC9zdHlsZT4KPC9oZWFkPgo8Ym9keT4KICAgIDxkaXYgY2xhc3M9ImNhcmQiPgogICAgICAgIDxoMT7wn5SUIFB1c2ggTm90aWZpY2F0aW9uIFRlc3Q8L2gxPgogICAgICAgIDxwPlRlc3QgdGhlIHB1c2ggbm90aWZpY2F0aW9uIHN5c3RlbSBmb3IgUHVyZU1hdGNoMjU0PC9wPgogICAgPC9kaXY+CgogICAgPGRpdiBjbGFzcz0iY2FyZCI+CiAgICAgICAgPGgyPjEuIEJyb3dzZXIgU3VwcG9ydCAmIFBlcm1pc3Npb248L2gyPgogICAgICAgIDxkaXYgaWQ9InN1cHBvcnQtc3RhdHVzIiBjbGFzcz0ic3RhdHVzIGluZm8iPkNoZWNraW5nIGJyb3dzZXIgc3VwcG9ydC4uLjwvZGl2PgogICAgICAgIDxidXR0b24gaWQ9InJlcXVlc3QtcGVybWlzc2lvbiIgZGlzYWJsZWQ+UmVxdWVzdCBQZXJtaXNzaW9uPC9idXR0b24+CiAgICAgICAgPGJ1dHRvbiBpZD0iY2hlY2stc3Vic2NyaXB0aW9uIiBkaXNhYmxlZD5DaGVjayBTdWJzY3JpcHRpb248L2J1dHRvbj4KICAgIDwvZGl2PgoKICAgIDxkaXYgY2xhc3M9ImNhcmQiPgogICAgICAgIDxoMj4yLiBTZXJ2aWNlIFdvcmtlcjwvaDI+CiAgICAgICAgPGRpdiBpZD0ic3ctc3RhdHVzIiBjbGFzcz0ic3RhdHVzIGluZm8iPkNoZWNraW5nIHNlcnZpY2Ugd29ya2VyLi4uPC9kaXY+CiAgICAgICAgPGJ1dHRvbiBpZD0icmVnaXN0ZXItc3ciIGRpc2FibGVkPlJlZ2lzdGVyIFNlcnZpY2UgV29ya2VyPC9idXR0b24+CiAgICAgICAgPGJ1dHRvbiBpZD0idW5yZWdpc3Rlci1zdyIgZGlzYWJsZWQ+VW5yZWdpc3RlciBTZXJ2aWNlIFdvcmtlcjwvYnV0dG9uPgogICAgPC9kaXY+CgogICAgPGRpdiBjbGFzcz0iY2FyZCI+CiAgICAgICAgPGgyPjMuIFRlc3QgTm90aWZpY2F0aW9uczwvaDI+CiAgICAgICAgPGRpdiBjbGFzcz0iZ3JpZCI+CiAgICAgICAgICAgIDxidXR0b24gaWQ9InRlc3QtYmFzaWMiIGRpc2FibGVkPkJhc2ljIE5vdGlmaWNhdGlvbjwvYnV0dG9uPgogICAgICAgICAgICA8YnV0dG9uIGlkPSJ0ZXN0LW1lc3NhZ2UiIGRpc2FibGVkPk1lc3NhZ2UgTm90aWZpY2F0aW9uPC9idXR0b24+CiAgICAgICAgICAgIDxidXR0b24gaWQ9InRlc3QtY2FsbCIgZGlzYWJsZWQ+SW5jb21pbmcgQ2FsbDwvYnV0dG9uPgogICAgICAgICAgICA8YnV0dG9uIGlkPSJ0ZXN0LW1hdGNoIiBkaXNhYmxlZD5OZXcgTWF0Y2g8L2J1dHRvbj4KICAgICAgICA8L2Rpdj4KICAgICAgICA8ZGl2IGlkPSJ0ZXN0LXN0YXR1cyIgY2xhc3M9InN0YXR1cyBpbmZvIiBzdHlsZT0iZGlzcGxheTpub25lOyI+PC9kaXY+CiAgICA8L2Rpdj4KCiAgICA8ZGl2IGNsYXNzPSJjYXJkIj4KICAgICAgICA8aDI+NC4gRGVidWcgSW5mbzwvaDI+CiAgICAgICAgPGJ1dHRvbiBpZD0ic2hvdy1kZWJ1ZyI+U2hvdyBEZWJ1ZyBJbmZvPC9idXR0b24+CiAgICAgICAgPHByZSBpZD0iZGVidWctaW5mbyIgc3R5bGU9ImRpc3BsYXk6bm9uZTsiPjwvcHJlPgogICAgPC9kaXY+CgogICAgPHNjcmlwdD4KICAgICAgICBjb25zdCBzdGF0dXNFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdXBwb3J0LXN0YXR1cycpOwogICAgICAgIGNvbnN0IHN3U3RhdHVzRWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3ctc3RhdHVzJyk7CiAgICAgICAgY29uc3QgdGVzdFN0YXR1c0VsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rlc3Qtc3RhdHVzJyk7CiAgICAgICAgY29uc3QgZGVidWdJbmZvRWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGVidWctaW5mbycpOwoKICAgICAgICBsZXQgcmVnaXN0cmF0aW9uID0gbnVsbDsKCiAgICAgICAgLy8gQ2hlY2sgYnJvd3NlciBzdXBwb3J0CiAgICAgICAgZnVuY3Rpb24gY2hlY2tTdXBwb3J0KCkgewogICAgICAgICAgICBjb25zdCBoYXNOb3RpZmljYXRpb25zID0gJ05vdGlmaWNhdGlvbicgaW4gd2luZG93OwogICAgICAgICAgICBjb25zdCBoYXNTVyA9ICdzZXJ2aWNlV29ya2VyJyBpbiBuYXZpZ2F0b3I7CiAgICAgICAgICAgIGNvbnN0IGhhc1B1c2ggPSAnUHVzaE1hbmFnZXInIGluIHdpbmRvdzsKCiAgICAgICAgICAgIGlmIChoYXNOb3RpZmljYXRpb25zICYmIGhhc1NXICYmIGhhc1B1c2gpIHsKICAgICAgICAgICAgICAgIHN0YXR1c0VsLnRleHRDb250ZW50ID0gYOKchSBCcm93c2VyIHN1cHBvcnRzIHB1c2ggbm90aWZpY2F0aW9ucy4gQ3VycmVudCBwZXJtaXNzaW9uOiAke05vdGlmaWNhdGlvbi5wZXJtaXNzaW9ufWA7CiAgICAgICAgICAgICAgICBzdGF0dXNFbC5jbGFzc05hbWUgPSAnc3RhdHVzIHN1Y2Nlc3MnOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlcXVlc3QtcGVybWlzc2lvbicpLmRpc2FibGVkID0gZmFsc2U7CiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVnaXN0ZXItc3cnKS5kaXNhYmxlZCA9IGZhbHNlOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgY29uc3QgbWlzc2luZyA9IFtdOwogICAgICAgICAgICAgICAgaWYgKCFoYXNOb3RpZmljYXRpb25zKSBtaXNzaW5nLnB1c2goJ05vdGlmaWNhdGlvbnMgQVBJJyk7CiAgICAgICAgICAgICAgICBpZiAoIWhhc1NXKSBtaXNzaW5nLnB1c2goJ1NlcnZpY2UgV29ya2VycycpOwogICAgICAgICAgICAgICAgaWYgKCFoYXNQdXNoKSBtaXNzaW5nLnB1c2goJ1B1c2ggTWFuYWdlcicpOwogICAgICAgICAgICAgICAgc3RhdHVzRWwudGV4dENvbnRlbnQgPSBg4p2MIE1pc3Npbmc6ICR7bWlzc2luZy5qb2luKCcsICcpfWA7CiAgICAgICAgICAgICAgICBzdGF0dXNFbC5jbGFzc05hbWUgPSAnc3RhdHVzIGVycm9yJzsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gUmVxdWVzdCBub3RpZmljYXRpb24gcGVybWlzc2lvbgogICAgICAgIGFzeW5jIGZ1bmN0aW9uIHJlcXVlc3RQZXJtaXNzaW9uKCkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgY29uc3QgcGVybWlzc2lvbiA9IGF3YWl0IE5vdGlmaWNhdGlvbi5yZXF1ZXN0UGVybWlzc2lvbigpOwogICAgICAgICAgICAgICAgc3RhdHVzRWwudGV4dENvbnRlbnQgPSBgUGVybWlzc2lvbjogJHtwZXJtaXNzaW9ufWA7CiAgICAgICAgICAgICAgICBzdGF0dXNFbC5jbGFzc05hbWUgPSBwZXJtaXNzaW9uID09PSAnZ3JhbnRlZCcgPyAnc3RhdHVzIHN1Y2Nlc3MnIDogJ3N0YXR1cyB3YXJuaW5nJzsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYgKHBlcm1pc3Npb24gPT09ICdncmFudGVkJykgewogICAgICAgICAgICAgICAgICAgIGVuYWJsZVRlc3RCdXR0b25zKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgICAgICBzdGF0dXNFbC50ZXh0Q29udGVudCA9IGBFcnJvcjogJHtlcnJvci5tZXNzYWdlfWA7CiAgICAgICAgICAgICAgICBzdGF0dXNFbC5jbGFzc05hbWUgPSAnc3RhdHVzIGVycm9yJzsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gUmVnaXN0ZXIgc2VydmljZSB3b3JrZXIKICAgICAgICBhc3luYyBmdW5jdGlvbiByZWdpc3RlclNlcnZpY2VXb3JrZXIoKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICByZWdpc3RyYXRpb24gPSBhd2FpdCBuYXZpZ2F0b3Iuc2VydmljZVdvcmtlci5yZWdpc3RlcignL3N3LmpzJywgeyBzY29wZTogJy8nIH0pOwogICAgICAgICAgICAgICAgYXdhaXQgbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIucmVhZHk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHN3U3RhdHVzRWwudGV4dENvbnRlbnQgPSBg4pyFIFNlcnZpY2UgV29ya2VyIHJlZ2lzdGVyZWQuIFN0YXRlOiAke3JlZ2lzdHJhdGlvbi5hY3RpdmU/LnN0YXRlfWA7CiAgICAgICAgICAgICAgICBzd1N0YXR1c0VsLmNsYXNzTmFtZSA9ICdzdGF0dXMgc3VjY2Vzcyc7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1bnJlZ2lzdGVyLXN3JykuZGlzYWJsZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjaGVjay1zdWJzY3JpcHRpb24nKS5kaXNhYmxlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBlbmFibGVUZXN0QnV0dG9ucygpOwogICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgICAgICAgc3dTdGF0dXNFbC50ZXh0Q29udGVudCA9IGDinYwgRXJyb3I6ICR7ZXJyb3IubWVzc2FnZX1gOwogICAgICAgICAgICAgICAgc3dTdGF0dXNFbC5jbGFzc05hbWUgPSAnc3RhdHVzIGVycm9yJzsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gVW5yZWdpc3RlciBzZXJ2aWNlIHdvcmtlcgogICAgICAgIGFzeW5jIGZ1bmN0aW9uIHVucmVnaXN0ZXJTZXJ2aWNlV29ya2VyKCkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgY29uc3QgcmVnaXN0cmF0aW9ucyA9IGF3YWl0IG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLmdldFJlZ2lzdHJhdGlvbnMoKTsKICAgICAgICAgICAgICAgIGZvciAobGV0IHJlZyBvZiByZWdpc3RyYXRpb25zKSB7CiAgICAgICAgICAgICAgICAgICAgYXdhaXQgcmVnLnVucmVnaXN0ZXIoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHN3U3RhdHVzRWwudGV4dENvbnRlbnQgPSAn4pyFIFNlcnZpY2UgV29ya2VyIHVucmVnaXN0ZXJlZCc7CiAgICAgICAgICAgICAgICBzd1N0YXR1c0VsLmNsYXNzTmFtZSA9ICdzdGF0dXMgaW5mbyc7CiAgICAgICAgICAgICAgICByZWdpc3RyYXRpb24gPSBudWxsOwogICAgICAgICAgICAgICAgZGlzYWJsZVRlc3RCdXR0b25zKCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgICAgICBzd1N0YXR1c0VsLnRleHRDb250ZW50ID0gYOKdjCBFcnJvcjogJHtlcnJvci5tZXNzYWdlfWA7CiAgICAgICAgICAgICAgICBzd1N0YXR1c0VsLmNsYXNzTmFtZSA9ICdzdGF0dXMgZXJyb3InOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBDaGVjayBzdWJzY3JpcHRpb24gc3RhdHVzCiAgICAgICAgYXN5bmMgZnVuY3Rpb24gY2hlY2tTdWJzY3JpcHRpb24oKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBjb25zdCByZWcgPSBhd2FpdCBuYXZpZ2F0b3Iuc2VydmljZVdvcmtlci5yZWFkeTsKICAgICAgICAgICAgICAgIGNvbnN0IHN1YnNjcmlwdGlvbiA9IGF3YWl0IHJlZy5wdXNoTWFuYWdlci5nZXRTdWJzY3JpcHRpb24oKTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYgKHN1YnNjcmlwdGlvbikgewogICAgICAgICAgICAgICAgICAgIHRlc3RTdGF0dXNFbC50ZXh0Q29udGVudCA9ICfinIUgUHVzaCBzdWJzY3JpcHRpb24gYWN0aXZlJzsKICAgICAgICAgICAgICAgICAgICB0ZXN0U3RhdHVzRWwuY2xhc3NOYW1lID0gJ3N0YXR1cyBzdWNjZXNzJzsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdGVzdFN0YXR1c0VsLnRleHRDb250ZW50ID0gJ+KaoO+4jyBObyBhY3RpdmUgcHVzaCBzdWJzY3JpcHRpb24nOwogICAgICAgICAgICAgICAgICAgIHRlc3RTdGF0dXNFbC5jbGFzc05hbWUgPSAnc3RhdHVzIHdhcm5pbmcnOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdGVzdFN0YXR1c0VsLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOwogICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgICAgICAgdGVzdFN0YXR1c0VsLnRleHRDb250ZW50ID0gYOKdjCBFcnJvcjogJHtlcnJvci5tZXNzYWdlfWA7CiAgICAgICAgICAgICAgICB0ZXN0U3RhdHVzRWwuY2xhc3NOYW1lID0gJ3N0YXR1cyBlcnJvcic7CiAgICAgICAgICAgICAgICB0ZXN0U3RhdHVzRWwuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIEVuYWJsZSB0ZXN0IGJ1dHRvbnMKICAgICAgICBmdW5jdGlvbiBlbmFibGVUZXN0QnV0dG9ucygpIHsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rlc3QtYmFzaWMnKS5kaXNhYmxlZCA9IGZhbHNlOwogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGVzdC1tZXNzYWdlJykuZGlzYWJsZWQgPSBmYWxzZTsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rlc3QtY2FsbCcpLmRpc2FibGVkID0gZmFsc2U7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0ZXN0LW1hdGNoJykuZGlzYWJsZWQgPSBmYWxzZTsKICAgICAgICB9CgogICAgICAgIC8vIERpc2FibGUgdGVzdCBidXR0b25zCiAgICAgICAgZnVuY3Rpb24gZGlzYWJsZVRlc3RCdXR0b25zKCkgewogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGVzdC1iYXNpYycpLmRpc2FibGVkID0gdHJ1ZTsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rlc3QtbWVzc2FnZScpLmRpc2FibGVkID0gdHJ1ZTsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rlc3QtY2FsbCcpLmRpc2FibGVkID0gdHJ1ZTsKICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rlc3QtbWF0Y2gnKS5kaXNhYmxlZCA9IHRydWU7CiAgICAgICAgfQoKICAgICAgICAvLyBUZXN0IGJhc2ljIG5vdGlmaWNhdGlvbgogICAgICAgIGFzeW5jIGZ1bmN0aW9uIHRlc3RCYXNpYygpIHsKICAgICAgICAgICAgY29uc3QgcmVnID0gYXdhaXQgbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIucmVhZHk7CiAgICAgICAgICAgIGF3YWl0IHJlZy5zaG93Tm90aWZpY2F0aW9uKCdUZXN0IE5vdGlmaWNhdGlvbicsIHsKICAgICAgICAgICAgICAgIGJvZHk6ICdUaGlzIGlzIGEgYmFzaWMgdGVzdCBub3RpZmljYXRpb24nLAogICAgICAgICAgICAgICAgaWNvbjogJy9sb2dvLnN2ZycsCiAgICAgICAgICAgICAgICBiYWRnZTogJy9mYXZpY29uLnN2ZycsCiAgICAgICAgICAgICAgICB0YWc6ICd0ZXN0LWJhc2ljJywKICAgICAgICAgICAgICAgIGRhdGE6IHsgdXJsOiAnLycsIHR5cGU6ICd0ZXN0JyB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBzaG93VGVzdFN0YXR1cygnQmFzaWMgbm90aWZpY2F0aW9uIHNlbnQhJyk7CiAgICAgICAgfQoKICAgICAgICAvLyBUZXN0IG1lc3NhZ2Ugbm90aWZpY2F0aW9uCiAgICAgICAgYXN5bmMgZnVuY3Rpb24gdGVzdE1lc3NhZ2UoKSB7CiAgICAgICAgICAgIGNvbnN0IHJlZyA9IGF3YWl0IG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLnJlYWR5OwogICAgICAgICAgICBhd2FpdCByZWcuc2hvd05vdGlmaWNhdGlvbignSm9obiBEb2UnLCB7CiAgICAgICAgICAgICAgICBib2R5OiAnSGV5ISBIb3cgYXJlIHlvdSBkb2luZz8g8J+YiicsCiAgICAgICAgICAgICAgICBpY29uOiAnL2xvZ28uc3ZnJywKICAgICAgICAgICAgICAgIGJhZGdlOiAnL2Zhdmljb24uc3ZnJywKICAgICAgICAgICAgICAgIHRhZzogJ21lc3NhZ2UtdGVzdCcsCiAgICAgICAgICAgICAgICBkYXRhOiB7IAogICAgICAgICAgICAgICAgICAgIHVybDogJy9tZXNzYWdlcycsCiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ21lc3NhZ2UnLAogICAgICAgICAgICAgICAgICAgIHNlbmRlcklkOiAndGVzdDEyMycKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBhY3Rpb25zOiBbCiAgICAgICAgICAgICAgICAgICAgeyBhY3Rpb246ICdyZXBseScsIHRpdGxlOiAn8J+SrCBSZXBseScsIGljb246ICcvbG9nby5zdmcnIH0sCiAgICAgICAgICAgICAgICAgICAgeyBhY3Rpb246ICd2aWV3JywgdGl0bGU6ICfwn5GB77iPIFZpZXcnLCBpY29uOiAnL2xvZ28uc3ZnJyB9CiAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgdmlicmF0ZTogWzIwMCwgMTAwLCAyMDBdCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBzaG93VGVzdFN0YXR1cygnTWVzc2FnZSBub3RpZmljYXRpb24gc2VudCEnKTsKICAgICAgICB9CgogICAgICAgIC8vIFRlc3QgaW5jb21pbmcgY2FsbCBub3RpZmljYXRpb24KICAgICAgICBhc3luYyBmdW5jdGlvbiB0ZXN0Q2FsbCgpIHsKICAgICAgICAgICAgY29uc3QgcmVnID0gYXdhaXQgbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIucmVhZHk7CiAgICAgICAgICAgIGF3YWl0IHJlZy5zaG93Tm90aWZpY2F0aW9uKCdJbmNvbWluZyBWaWRlbyBDYWxsIPCfk54nLCB7CiAgICAgICAgICAgICAgICBib2R5OiAnU2FyYWggSm9obnNvbiBpcyBjYWxsaW5nIHlvdS4uLicsCiAgICAgICAgICAgICAgICBpY29uOiAnL2xvZ28uc3ZnJywKICAgICAgICAgICAgICAgIGJhZGdlOiAnL2Zhdmljb24uc3ZnJywKICAgICAgICAgICAgICAgIHRhZzogJ2luY29taW5nLWNhbGwnLAogICAgICAgICAgICAgICAgcmVxdWlyZUludGVyYWN0aW9uOiB0cnVlLAogICAgICAgICAgICAgICAgZGF0YTogeyAKICAgICAgICAgICAgICAgICAgICB1cmw6ICcvY2FsbC90ZXN0MTIzJywKICAgICAgICAgICAgICAgICAgICB0eXBlOiAnY2FsbF9pbmNvbWluZycsCiAgICAgICAgICAgICAgICAgICAgY2FsbElkOiAndGVzdDEyMycsCiAgICAgICAgICAgICAgICAgICAgY2FsbFR5cGU6ICd2aWRlbycKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBhY3Rpb25zOiBbCiAgICAgICAgICAgICAgICAgICAgeyBhY3Rpb246ICdhbnN3ZXInLCB0aXRsZTogJ/Cfk54gQW5zd2VyJywgaWNvbjogJy9sb2dvLnN2ZycgfSwKICAgICAgICAgICAgICAgICAgICB7IGFjdGlvbjogJ2RlY2xpbmUnLCB0aXRsZTogJ+KdjCBEZWNsaW5lJywgaWNvbjogJy9sb2dvLnN2ZycgfQogICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgIHZpYnJhdGU6IFs1MDAsIDIwMCwgNTAwLCAyMDAsIDUwMF0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHNob3dUZXN0U3RhdHVzKCdDYWxsIG5vdGlmaWNhdGlvbiBzZW50ISAod2lsbCBzdGF5IHVudGlsIHlvdSBpbnRlcmFjdCknKTsKICAgICAgICB9CgogICAgICAgIC8vIFRlc3QgbWF0Y2ggbm90aWZpY2F0aW9uCiAgICAgICAgYXN5bmMgZnVuY3Rpb24gdGVzdE1hdGNoKCkgewogICAgICAgICAgICBjb25zdCByZWcgPSBhd2FpdCBuYXZpZ2F0b3Iuc2VydmljZVdvcmtlci5yZWFkeTsKICAgICAgICAgICAgYXdhaXQgcmVnLnNob3dOb3RpZmljYXRpb24oJ05ldyBNYXRjaCEg8J+SlicsIHsKICAgICAgICAgICAgICAgIGJvZHk6ICdZb3UgYW5kIEVtbWEgbWF0Y2hlZCEgU2F5IGhpLicsCiAgICAgICAgICAgICAgICBpY29uOiAnL2xvZ28uc3ZnJywKICAgICAgICAgICAgICAgIGJhZGdlOiAnL2Zhdmljb24uc3ZnJywKICAgICAgICAgICAgICAgIHRhZzogJ21hdGNoLXRlc3QnLAogICAgICAgICAgICAgICAgZGF0YTogeyAKICAgICAgICAgICAgICAgICAgICB1cmw6ICcvbWF0Y2hlcycsCiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ21hdGNoJwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGFjdGlvbnM6IFsKICAgICAgICAgICAgICAgICAgICB7IGFjdGlvbjogJ3ZpZXcnLCB0aXRsZTogJ/CfkYsgU2F5IEhpJywgaWNvbjogJy9sb2dvLnN2ZycgfQogICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgIHZpYnJhdGU6IFszMDAsIDEwMCwgMzAwXQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgc2hvd1Rlc3RTdGF0dXMoJ01hdGNoIG5vdGlmaWNhdGlvbiBzZW50IScpOwogICAgICAgIH0KCiAgICAgICAgLy8gU2hvdyB0ZXN0IHN0YXR1cwogICAgICAgIGZ1bmN0aW9uIHNob3dUZXN0U3RhdHVzKG1lc3NhZ2UpIHsKICAgICAgICAgICAgdGVzdFN0YXR1c0VsLnRleHRDb250ZW50ID0gbWVzc2FnZTsKICAgICAgICAgICAgdGVzdFN0YXR1c0VsLmNsYXNzTmFtZSA9ICdzdGF0dXMgc3VjY2Vzcyc7CiAgICAgICAgICAgIHRlc3RTdGF0dXNFbC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICB0ZXN0U3RhdHVzRWwuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICAgICAgfSwgMzAwMCk7CiAgICAgICAgfQoKICAgICAgICAvLyBTaG93IGRlYnVnIGluZm8KICAgICAgICBhc3luYyBmdW5jdGlvbiBzaG93RGVidWcoKSB7CiAgICAgICAgICAgIGNvbnN0IGluZm8gPSB7CiAgICAgICAgICAgICAgICB1c2VyQWdlbnQ6IG5hdmlnYXRvci51c2VyQWdlbnQsCiAgICAgICAgICAgICAgICBwbGF0Zm9ybTogbmF2aWdhdG9yLnBsYXRmb3JtLAogICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uUGVybWlzc2lvbjogTm90aWZpY2F0aW9uLnBlcm1pc3Npb24sCiAgICAgICAgICAgICAgICBzZXJ2aWNlV29ya2VyU3VwcG9ydDogJ3NlcnZpY2VXb3JrZXInIGluIG5hdmlnYXRvciwKICAgICAgICAgICAgICAgIHB1c2hTdXBwb3J0OiAnUHVzaE1hbmFnZXInIGluIHdpbmRvdywKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIGlmICgnc2VydmljZVdvcmtlcicgaW4gbmF2aWdhdG9yKSB7CiAgICAgICAgICAgICAgICBjb25zdCByZWdpc3RyYXRpb25zID0gYXdhaXQgbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIuZ2V0UmVnaXN0cmF0aW9ucygpOwogICAgICAgICAgICAgICAgaW5mby5zZXJ2aWNlV29ya2VyUmVnaXN0cmF0aW9ucyA9IHJlZ2lzdHJhdGlvbnMubGVuZ3RoOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBpZiAocmVnaXN0cmF0aW9ucy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVnID0gcmVnaXN0cmF0aW9uc1swXTsKICAgICAgICAgICAgICAgICAgICBpbmZvLnNlcnZpY2VXb3JrZXJTdGF0ZSA9IHJlZy5hY3RpdmU/LnN0YXRlOwogICAgICAgICAgICAgICAgICAgIGluZm8uc2VydmljZVdvcmtlclNjb3BlID0gcmVnLnNjb3BlOwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGNvbnN0IHN1YnNjcmlwdGlvbiA9IGF3YWl0IHJlZy5wdXNoTWFuYWdlci5nZXRTdWJzY3JpcHRpb24oKTsKICAgICAgICAgICAgICAgICAgICBpbmZvLmhhc1B1c2hTdWJzY3JpcHRpb24gPSAhIXN1YnNjcmlwdGlvbjsKICAgICAgICAgICAgICAgICAgICBpZiAoc3Vic2NyaXB0aW9uKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGluZm8uc3Vic2NyaXB0aW9uRW5kcG9pbnQgPSBzdWJzY3JpcHRpb24uZW5kcG9pbnQuc3Vic3RyaW5nKDAsIDUwKSArICcuLi4nOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgZGVidWdJbmZvRWwudGV4dENvbnRlbnQgPSBKU09OLnN0cmluZ2lmeShpbmZvLCBudWxsLCAyKTsKICAgICAgICAgICAgZGVidWdJbmZvRWwuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICAgICAgfQoKICAgICAgICAvLyBFdmVudCBsaXN0ZW5lcnMKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVxdWVzdC1wZXJtaXNzaW9uJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCByZXF1ZXN0UGVybWlzc2lvbik7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlZ2lzdGVyLXN3JykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCByZWdpc3RlclNlcnZpY2VXb3JrZXIpOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1bnJlZ2lzdGVyLXN3JykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB1bnJlZ2lzdGVyU2VydmljZVdvcmtlcik7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NoZWNrLXN1YnNjcmlwdGlvbicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2hlY2tTdWJzY3JpcHRpb24pOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0ZXN0LWJhc2ljJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0ZXN0QmFzaWMpOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0ZXN0LW1lc3NhZ2UnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRlc3RNZXNzYWdlKTsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGVzdC1jYWxsJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0ZXN0Q2FsbCk7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rlc3QtbWF0Y2gnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRlc3RNYXRjaCk7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3ctZGVidWcnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNob3dEZWJ1Zyk7CgogICAgICAgIC8vIEluaXRpYWxpemUKICAgICAgICBjaGVja1N1cHBvcnQoKTsKCiAgICAgICAgLy8gQ2hlY2sgaWYgc2VydmljZSB3b3JrZXIgaXMgYWxyZWFkeSByZWdpc3RlcmVkCiAgICAgICAgbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIuZ2V0UmVnaXN0cmF0aW9ucygpLnRoZW4ocmVnaXN0cmF0aW9ucyA9PiB7CiAgICAgICAgICAgIGlmIChyZWdpc3RyYXRpb25zLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgIHJlZ2lzdHJhdGlvbiA9IHJlZ2lzdHJhdGlvbnNbMF07CiAgICAgICAgICAgICAgICBzd1N0YXR1c0VsLnRleHRDb250ZW50ID0gYOKchSBTZXJ2aWNlIFdvcmtlciBhbHJlYWR5IHJlZ2lzdGVyZWQuIFN0YXRlOiAke3JlZ2lzdHJhdGlvbi5hY3RpdmU/LnN0YXRlfWA7CiAgICAgICAgICAgICAgICBzd1N0YXR1c0VsLmNsYXNzTmFtZSA9ICdzdGF0dXMgc3VjY2Vzcyc7CiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndW5yZWdpc3Rlci1zdycpLmRpc2FibGVkID0gZmFsc2U7CiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2hlY2stc3Vic2NyaXB0aW9uJykuZGlzYWJsZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYgKE5vdGlmaWNhdGlvbi5wZXJtaXNzaW9uID09PSAnZ3JhbnRlZCcpIHsKICAgICAgICAgICAgICAgICAgICBlbmFibGVUZXN0QnV0dG9ucygpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICA8L3NjcmlwdD4KPC9ib2R5Pgo8L2h0bWw+Cg=="}